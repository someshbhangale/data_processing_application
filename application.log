2023-10-14 11:35:25,865 - root - INFO - i am in thr main method...
2023-10-14 11:35:25,865 - root - INFO - calling spark object
2023-10-14 11:35:25,865 - root - INFO - get_spark_object method started
2023-10-14 11:35:25,866 - Create_spark - INFO - master is local
2023-10-14 11:35:39,690 - Create_spark - INFO - Spark object created........
2023-10-14 11:35:39,690 - root - INFO - Validating spark object.............
2023-10-14 11:35:39,690 - Validate - WARNING - started the get_current_date method...
2023-10-14 11:35:44,861 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 11:35:44,865 - Validate - WARNING - Validation done , go frwd....
2023-10-14 11:35:44,865 - root - INFO - Application done
2023-10-14 11:38:49,667 - root - INFO - i am in the main method...
2023-10-14 11:38:49,667 - root - INFO - calling spark object
2023-10-14 11:38:49,667 - root - INFO - get_spark_object method started
2023-10-14 11:38:49,668 - Create_spark - INFO - master is local
2023-10-14 11:38:56,074 - Create_spark - INFO - Spark object created........
2023-10-14 11:38:56,074 - root - INFO - Validating spark object.............
2023-10-14 11:38:56,075 - Validate - WARNING - started the get_current_date method...
2023-10-14 11:39:01,026 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 11:39:01,026 - Validate - WARNING - Validation done , go frwd....
2023-10-14 11:39:01,027 - root - INFO - Application done
2023-10-14 11:39:36,615 - root - INFO - i am in the main method...
2023-10-14 11:39:36,615 - root - INFO - calling spark object
2023-10-14 11:39:36,616 - root - INFO - get_spark_object method started
2023-10-14 11:39:36,616 - Create_spark - INFO - master is local
2023-10-14 11:39:43,273 - Create_spark - INFO - Spark object created........
2023-10-14 11:39:43,273 - root - INFO - Validating spark object.............
2023-10-14 11:39:43,274 - Validate - WARNING - started the get_current_date method...
2023-10-14 11:39:49,068 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 11:39:49,068 - Validate - WARNING - Validation done , go frwd....
2023-10-14 11:39:49,068 - root - INFO - Application done
2023-10-14 11:43:44,148 - root - INFO - i am in the main method...
2023-10-14 11:43:44,149 - root - INFO - calling spark object
2023-10-14 11:43:44,149 - root - INFO - get_spark_object method started
2023-10-14 11:43:44,149 - Create_spark - INFO - master is local
2023-10-14 11:43:50,443 - Create_spark - INFO - Spark object created........
2023-10-14 11:43:50,443 - root - INFO - Validating spark object.............
2023-10-14 11:43:50,444 - Validate - WARNING - started the get_current_date method...
2023-10-14 11:43:55,452 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 11:43:55,452 - Validate - WARNING - Validation done , go frwd....
2023-10-14 11:43:55,453 - root - INFO - Application done
2023-10-14 12:06:26,028 - root - INFO - i am in the main method...
2023-10-14 12:06:26,028 - root - INFO - calling spark object
2023-10-14 12:06:26,028 - root - INFO - get_spark_object method started
2023-10-14 12:06:26,028 - Create_spark - INFO - master is local
2023-10-14 12:06:32,376 - Create_spark - INFO - Spark object created........
2023-10-14 12:06:32,376 - root - INFO - Validating spark object.............
2023-10-14 12:06:32,377 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:06:37,723 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:06:37,723 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:06:37,724 - root - INFO - reading file which is of > parquet 
2023-10-14 12:06:37,724 - Ingest - WARNING - load_files method started.....
2023-10-14 12:06:38,579 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:06:38,583 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2023-10-14 12:08:33,391 - root - INFO - i am in the main method...
2023-10-14 12:08:33,391 - root - INFO - calling spark object
2023-10-14 12:08:33,391 - root - INFO - get_spark_object method started
2023-10-14 12:08:33,392 - Create_spark - INFO - master is local
2023-10-14 12:08:39,476 - Create_spark - INFO - Spark object created........
2023-10-14 12:08:39,476 - root - INFO - Validating spark object.............
2023-10-14 12:08:39,476 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:08:44,581 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:08:44,581 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:08:44,581 - root - INFO - reading file which is of > parquet 
2023-10-14 12:08:44,582 - Ingest - WARNING - load_files method started.....
2023-10-14 12:08:45,375 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:08:45,380 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2023-10-14 12:08:48,053 - root - INFO - Application done
2023-10-14 12:14:02,887 - root - INFO - i am in the main method...
2023-10-14 12:14:02,887 - root - INFO - calling spark object
2023-10-14 12:14:02,887 - root - INFO - get_spark_object method started
2023-10-14 12:14:02,888 - Create_spark - INFO - master is local
2023-10-14 12:14:09,185 - Create_spark - INFO - Spark object created........
2023-10-14 12:14:09,185 - root - INFO - Validating spark object.............
2023-10-14 12:14:09,186 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:14:15,361 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:14:15,361 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:14:15,361 - root - INFO - reading file which is of > parquet 
2023-10-14 12:14:15,362 - Ingest - WARNING - load_files method started.....
2023-10-14 12:14:16,295 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:14:16,299 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2023-10-14 12:14:19,091 - root - INFO - validating the dataframe....
2023-10-14 12:14:19,091 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:14:19,851 - Ingest - WARNING - Number of records present in th DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:14:19,851 - root - INFO - Application done
2023-10-14 12:23:20,314 - root - INFO - i am in the main method...
2023-10-14 12:23:20,315 - root - INFO - calling spark object
2023-10-14 12:23:20,315 - root - INFO - get_spark_object method started
2023-10-14 12:23:20,315 - Create_spark - INFO - master is local
2023-10-14 12:23:34,577 - Create_spark - INFO - Spark object created........
2023-10-14 12:23:34,577 - root - INFO - Validating spark object.............
2023-10-14 12:23:34,577 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:23:39,589 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:23:39,589 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:23:39,590 - root - INFO - reading file which is of > csv 
2023-10-14 12:23:39,590 - Ingest - WARNING - load_files method started.....
2023-10-14 12:27:44,707 - root - INFO - i am in the main method...
2023-10-14 12:27:44,707 - root - INFO - calling spark object
2023-10-14 12:27:44,707 - root - INFO - get_spark_object method started
2023-10-14 12:27:44,708 - Create_spark - INFO - master is local
2023-10-14 12:27:50,504 - Create_spark - INFO - Spark object created........
2023-10-14 12:27:50,504 - root - INFO - Validating spark object.............
2023-10-14 12:27:50,504 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:27:55,582 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:27:55,582 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:27:55,582 - root - INFO - reading file which is of > parquet 
2023-10-14 12:27:55,582 - Ingest - WARNING - load_files method started.....
2023-10-14 12:27:56,398 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:27:56,403 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2023-10-14 12:27:58,990 - root - INFO - validating the dataframe....
2023-10-14 12:27:58,990 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:27:59,779 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:27:59,780 - root - INFO - reading file which is of > csv 
2023-10-14 12:27:59,780 - Ingest - WARNING - load_files method started.....
2023-10-14 12:35:58,279 - root - INFO - i am in the main method...
2023-10-14 12:35:58,280 - root - INFO - calling spark object
2023-10-14 12:35:58,280 - root - INFO - get_spark_object method started
2023-10-14 12:35:58,280 - Create_spark - INFO - master is local
2023-10-14 12:36:04,476 - Create_spark - INFO - Spark object created........
2023-10-14 12:36:04,476 - root - INFO - Validating spark object.............
2023-10-14 12:36:04,476 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:36:09,440 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:36:09,441 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:36:09,441 - root - INFO - reading file which is of > parquet 
2023-10-14 12:36:09,441 - Ingest - WARNING - load_files method started.....
2023-10-14 12:36:10,268 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:36:10,273 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2023-10-14 12:36:12,846 - root - INFO - validating the dataframe....
2023-10-14 12:36:12,846 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:36:13,586 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:36:13,586 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:36:13,586 - root - INFO - reading file which is of > csv 
2023-10-14 12:36:13,587 - Ingest - WARNING - load_files method started.....
2023-10-14 12:37:15,344 - root - INFO - i am in the main method...
2023-10-14 12:37:15,344 - root - INFO - calling spark object
2023-10-14 12:37:15,344 - root - INFO - get_spark_object method started
2023-10-14 12:37:15,344 - Create_spark - INFO - master is local
2023-10-14 12:37:21,316 - Create_spark - INFO - Spark object created........
2023-10-14 12:37:21,317 - root - INFO - Validating spark object.............
2023-10-14 12:37:21,317 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:37:26,364 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:37:26,364 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:37:26,365 - root - INFO - reading file which is of > parquet 
2023-10-14 12:37:26,365 - Ingest - WARNING - load_files method started.....
2023-10-14 12:37:27,262 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:37:27,267 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2023-10-14 12:37:29,788 - root - INFO - validating the dataframe....
2023-10-14 12:37:29,788 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:37:30,604 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:37:30,604 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:37:30,605 - root - INFO - reading file which is of > csv 
2023-10-14 12:37:30,605 - Ingest - WARNING - load_files method started.....
2023-10-14 12:42:59,729 - root - INFO - i am in the main method...
2023-10-14 12:42:59,729 - root - INFO - calling spark object
2023-10-14 12:42:59,729 - root - INFO - get_spark_object method started
2023-10-14 12:42:59,729 - Create_spark - INFO - master is local
2023-10-14 12:43:05,593 - Create_spark - INFO - Spark object created........
2023-10-14 12:43:05,593 - root - INFO - Validating spark object.............
2023-10-14 12:43:05,594 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:43:11,351 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:43:11,352 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:43:11,352 - root - INFO - reading file which is of > parquet 
2023-10-14 12:43:11,352 - Ingest - WARNING - load_files method started.....
2023-10-14 12:43:12,226 - Ingest - WARNING - dataframe created successfully which is of parquet
2023-10-14 12:43:12,227 - root - INFO - displaying file
2023-10-14 12:43:14,688 - root - INFO - validating the dataframe....
2023-10-14 12:43:14,688 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:43:15,508 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:43:15,508 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:43:15,509 - root - INFO - reading file which is of > csv 
2023-10-14 12:43:15,509 - Ingest - WARNING - load_files method started.....
2023-10-14 12:47:39,677 - root - INFO - i am in the main method...
2023-10-14 12:47:39,678 - root - INFO - calling spark object
2023-10-14 12:47:39,678 - root - INFO - get_spark_object method started
2023-10-14 12:47:39,678 - Create_spark - INFO - master is local
2023-10-14 12:47:46,651 - Create_spark - INFO - Spark object created........
2023-10-14 12:47:46,651 - root - INFO - Validating spark object.............
2023-10-14 12:47:46,651 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:47:51,566 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:47:51,566 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:47:51,566 - root - INFO - reading file which is of > parquet 
2023-10-14 12:47:51,567 - Ingest - WARNING - load_files method started.....
2023-10-14 12:47:52,462 - Ingest - WARNING - Load_files func done, go fwd...
2023-10-14 12:47:52,463 - root - INFO - displaying file
2023-10-14 12:47:54,855 - root - INFO - validating the dataframe....
2023-10-14 12:47:54,855 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:47:55,765 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:47:55,766 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:47:55,766 - root - INFO - reading file which is of > csv 
2023-10-14 12:47:55,766 - Ingest - WARNING - load_files method started.....
2023-10-14 12:56:08,223 - root - INFO - i am in the main method...
2023-10-14 12:56:08,223 - root - INFO - calling spark object
2023-10-14 12:56:08,223 - root - INFO - get_spark_object method started
2023-10-14 12:56:08,223 - Create_spark - INFO - master is local
2023-10-14 12:56:14,863 - Create_spark - INFO - Spark object created........
2023-10-14 12:56:14,863 - root - INFO - Validating spark object.............
2023-10-14 12:56:14,863 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:56:19,862 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:56:19,862 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:56:19,863 - root - INFO - reading file which is of > parquet 
2023-10-14 12:56:19,863 - Ingest - WARNING - load_files method started.....
2023-10-14 12:56:20,665 - Ingest - WARNING - Load_files func done, go fwd...
2023-10-14 12:56:20,665 - root - INFO - displaying file
2023-10-14 12:56:23,280 - root - INFO - validating the dataframe....
2023-10-14 12:56:23,280 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:56:24,079 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:56:24,079 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:56:24,080 - root - INFO - reading file which is of > csv
2023-10-14 12:56:24,080 - Ingest - WARNING - load_files method started.....
2023-10-14 12:58:45,895 - root - INFO - i am in the main method...
2023-10-14 12:58:45,895 - root - INFO - calling spark object
2023-10-14 12:58:45,895 - root - INFO - get_spark_object method started
2023-10-14 12:58:45,896 - Create_spark - INFO - master is local
2023-10-14 12:58:52,081 - Create_spark - INFO - Spark object created........
2023-10-14 12:58:52,081 - root - INFO - Validating spark object.............
2023-10-14 12:58:52,081 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:58:56,973 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:58:56,973 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:58:56,974 - root - INFO - reading file which is of > parquet 
2023-10-14 12:58:56,974 - Ingest - WARNING - load_files method started
2023-10-14 12:58:57,871 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 12:58:57,871 - root - INFO - displaying file
2023-10-14 12:59:00,353 - root - INFO - validating the dataframe....
2023-10-14 12:59:00,353 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:59:01,203 - Ingest - WARNING - number of records 28338 :: 
2023-10-14 12:59:01,203 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:59:01,203 - root - INFO - reading file which is of > csv
2023-10-14 12:59:01,204 - Ingest - WARNING - load_files method started
2023-10-14 12:59:08,443 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 12:59:08,444 - root - INFO - displaying the df_fact dataframe
2023-10-14 12:59:08,899 - root - INFO - Application done
2023-10-14 12:59:26,265 - root - INFO - i am in the main method...
2023-10-14 12:59:26,266 - root - INFO - calling spark object
2023-10-14 12:59:26,266 - root - INFO - get_spark_object method started
2023-10-14 12:59:26,266 - Create_spark - INFO - master is local
2023-10-14 12:59:32,206 - Create_spark - INFO - Spark object created........
2023-10-14 12:59:32,206 - root - INFO - Validating spark object.............
2023-10-14 12:59:32,206 - Validate - WARNING - started the get_current_date method...
2023-10-14 12:59:37,210 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 12:59:37,210 - Validate - WARNING - Validation done , go frwd....
2023-10-14 12:59:37,211 - root - INFO - reading file which is of > parquet 
2023-10-14 12:59:37,211 - Ingest - WARNING - load_files method started
2023-10-14 12:59:38,056 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 12:59:38,056 - root - INFO - displaying file
2023-10-14 12:59:40,900 - root - INFO - validating the dataframe....
2023-10-14 12:59:40,900 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 12:59:41,767 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 12:59:41,768 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 12:59:41,768 - root - INFO - reading file which is of > csv
2023-10-14 12:59:41,768 - Ingest - WARNING - load_files method started
2023-10-14 12:59:48,753 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 12:59:48,753 - root - INFO - displaying the df_fact dataframe
2023-10-14 12:59:49,152 - root - INFO - Application done
2023-10-14 13:00:13,618 - root - INFO - i am in the main method...
2023-10-14 13:00:13,618 - root - INFO - calling spark object
2023-10-14 13:00:13,619 - root - INFO - get_spark_object method started
2023-10-14 13:00:13,619 - Create_spark - INFO - master is local
2023-10-14 13:00:19,702 - Create_spark - INFO - Spark object created........
2023-10-14 13:00:19,702 - root - INFO - Validating spark object.............
2023-10-14 13:00:19,702 - Validate - WARNING - started the get_current_date method...
2023-10-14 13:00:24,719 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 13:00:24,719 - Validate - WARNING - Validation done , go frwd....
2023-10-14 13:00:24,720 - root - INFO - reading file which is of > parquet 
2023-10-14 13:00:24,720 - Ingest - WARNING - load_files method started
2023-10-14 13:00:25,534 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:00:25,534 - root - INFO - displaying file
2023-10-14 13:00:28,287 - root - INFO - validating the dataframe....
2023-10-14 13:00:28,287 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 13:00:29,090 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 13:00:29,090 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 13:00:29,091 - root - INFO - reading file which is of > csv
2023-10-14 13:00:29,091 - Ingest - WARNING - load_files method started
2023-10-14 13:00:35,635 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:00:35,636 - root - INFO - displaying the df_fact dataframe
2023-10-14 13:00:36,063 - root - INFO - Application done
2023-10-14 13:30:30,253 - root - INFO - i am in the main method...
2023-10-14 13:30:30,253 - root - INFO - calling spark object
2023-10-14 13:30:30,253 - root - INFO - get_spark_object method started
2023-10-14 13:30:30,253 - Create_spark - INFO - master is local
2023-10-14 13:30:38,937 - Create_spark - INFO - Spark object created........
2023-10-14 13:30:38,937 - root - INFO - Validating spark object.............
2023-10-14 13:30:38,937 - Validate - WARNING - started the get_current_date method...
2023-10-14 13:30:46,116 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 13:30:46,116 - Validate - WARNING - Validation done , go frwd....
2023-10-14 13:30:46,117 - root - INFO - reading file which is of > parquet 
2023-10-14 13:30:46,117 - Ingest - WARNING - load_files method started
2023-10-14 13:30:47,236 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:30:47,236 - root - INFO - displaying file
2023-10-14 13:30:50,778 - root - INFO - validating the dataframe....
2023-10-14 13:30:50,778 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 13:30:52,013 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 13:30:52,013 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 13:30:52,014 - root - INFO - reading file which is of > csv
2023-10-14 13:30:52,014 - Ingest - WARNING - load_files method started
2023-10-14 13:31:01,562 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:31:01,562 - root - INFO - displaying the df_fact dataframe
2023-10-14 13:31:02,115 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 13:31:03,502 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 13:31:03,502 - root - INFO - implementing data_processing methods.....
2023-10-14 13:31:03,502 - Data_processing - WARNING - data_clean method() started....
2023-10-14 13:31:03,503 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 13:33:05,423 - root - INFO - i am in the main method...
2023-10-14 13:33:05,424 - root - INFO - calling spark object
2023-10-14 13:33:05,424 - root - INFO - get_spark_object method started
2023-10-14 13:33:05,424 - Create_spark - INFO - master is local
2023-10-14 13:33:14,713 - Create_spark - INFO - Spark object created........
2023-10-14 13:33:14,713 - root - INFO - Validating spark object.............
2023-10-14 13:33:14,713 - Validate - WARNING - started the get_current_date method...
2023-10-14 13:33:22,335 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 13:33:22,335 - Validate - WARNING - Validation done , go frwd....
2023-10-14 13:33:22,336 - root - INFO - reading file which is of > parquet 
2023-10-14 13:33:22,336 - Ingest - WARNING - load_files method started
2023-10-14 13:33:23,529 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:33:23,529 - root - INFO - displaying file
2023-10-14 13:33:26,952 - root - INFO - validating the dataframe....
2023-10-14 13:33:26,953 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 13:33:27,972 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 13:33:27,972 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 13:33:27,973 - root - INFO - reading file which is of > csv
2023-10-14 13:33:27,973 - Ingest - WARNING - load_files method started
2023-10-14 13:33:37,611 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:33:37,611 - root - INFO - displaying the df_fact dataframe
2023-10-14 13:33:38,428 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 13:33:40,288 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 13:33:40,288 - root - INFO - implementing data_processing methods.....
2023-10-14 13:33:40,289 - Data_processing - WARNING - data_clean method() started....
2023-10-14 13:33:40,289 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 13:33:40,365 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 13:33:40,400 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 13:33:41,149 - root - INFO - Application done
2023-10-14 13:36:31,976 - root - INFO - i am in the main method...
2023-10-14 13:36:31,976 - root - INFO - calling spark object
2023-10-14 13:36:31,976 - root - INFO - get_spark_object method started
2023-10-14 13:36:31,977 - Create_spark - INFO - master is local
2023-10-14 13:36:40,227 - Create_spark - INFO - Spark object created........
2023-10-14 13:36:40,227 - root - INFO - Validating spark object.............
2023-10-14 13:36:40,228 - Validate - WARNING - started the get_current_date method...
2023-10-14 13:36:47,732 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 13:36:47,732 - Validate - WARNING - Validation done , go frwd....
2023-10-14 13:36:47,732 - root - INFO - reading file which is of > parquet 
2023-10-14 13:36:47,733 - Ingest - WARNING - load_files method started
2023-10-14 13:36:48,886 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:36:48,886 - root - INFO - displaying file
2023-10-14 13:36:52,662 - root - INFO - validating the dataframe....
2023-10-14 13:36:52,662 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 13:36:53,717 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 13:36:53,717 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 13:36:53,717 - root - INFO - reading file which is of > csv
2023-10-14 13:36:53,719 - Ingest - WARNING - load_files method started
2023-10-14 13:37:03,613 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:37:03,614 - root - INFO - displaying the df_fact dataframe
2023-10-14 13:37:04,183 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 13:37:05,575 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 13:37:05,576 - root - INFO - implementing data_processing methods.....
2023-10-14 13:37:05,576 - Data_processing - WARNING - data_clean method() started....
2023-10-14 13:37:05,576 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 13:37:05,648 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 13:37:05,689 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 13:37:05,709 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 13:37:06,430 - root - INFO - Application done
2023-10-14 13:45:05,820 - root - INFO - i am in the main method...
2023-10-14 13:45:05,820 - root - INFO - calling spark object
2023-10-14 13:45:05,820 - root - INFO - get_spark_object method started
2023-10-14 13:45:05,821 - Create_spark - INFO - master is local
2023-10-14 13:45:14,190 - Create_spark - INFO - Spark object created........
2023-10-14 13:45:14,190 - root - INFO - Validating spark object.............
2023-10-14 13:45:14,190 - Validate - WARNING - started the get_current_date method...
2023-10-14 13:45:21,307 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 13:45:21,307 - Validate - WARNING - Validation done , go frwd....
2023-10-14 13:45:21,307 - root - INFO - reading file which is of > parquet 
2023-10-14 13:45:21,308 - Ingest - WARNING - load_files method started
2023-10-14 13:45:22,530 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:45:22,530 - root - INFO - displaying file
2023-10-14 13:45:26,263 - root - INFO - validating the dataframe....
2023-10-14 13:45:26,263 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 13:45:27,252 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 13:45:27,252 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 13:45:27,252 - root - INFO - reading file which is of > csv
2023-10-14 13:45:27,253 - Ingest - WARNING - load_files method started
2023-10-14 13:45:36,548 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 13:45:36,548 - root - INFO - displaying the df_fact dataframe
2023-10-14 13:45:37,073 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 13:45:38,393 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 13:45:38,394 - root - INFO - implementing data_processing methods.....
2023-10-14 13:45:38,394 - Data_processing - WARNING - data_clean method() started....
2023-10-14 13:45:38,394 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 13:45:38,473 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 13:45:38,515 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 13:45:38,540 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 13:45:39,351 - root - INFO - validating schema for the dataframes.......
2023-10-14 13:45:39,351 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 13:45:39,356 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 13:45:39,356 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 13:45:39,357 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 13:45:39,357 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 13:45:39,357 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 13:45:39,357 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 13:45:39,357 - Validate - INFO - print_schema done, go frwd....
2023-10-14 13:45:39,357 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 13:45:39,359 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 13:45:39,359 - Validate - INFO - 	StructField('presc_lname', StringType(), True)
2023-10-14 13:45:39,360 - Validate - INFO - 	StructField('presc_fname', StringType(), True)
2023-10-14 13:45:39,360 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 13:45:39,360 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 13:45:39,360 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 13:45:39,360 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 13:45:39,362 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 13:45:39,362 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 13:45:39,364 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 13:45:39,364 - Validate - INFO - 	StructField('years_of_exp', StringType(), True)
2023-10-14 13:45:39,364 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 13:45:39,364 - Validate - INFO - print_schema done, go frwd....
2023-10-14 13:45:39,364 - root - INFO - Application done
2023-10-14 14:26:52,135 - root - INFO - i am in the main method...
2023-10-14 14:26:52,135 - root - INFO - calling spark object
2023-10-14 14:26:52,136 - root - INFO - get_spark_object method started
2023-10-14 14:26:52,136 - Create_spark - INFO - master is local
2023-10-14 14:27:00,690 - Create_spark - INFO - Spark object created........
2023-10-14 14:27:00,690 - root - INFO - Validating spark object.............
2023-10-14 14:27:00,690 - Validate - WARNING - started the get_current_date method...
2023-10-14 14:27:07,858 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 14:27:07,858 - Validate - WARNING - Validation done , go frwd....
2023-10-14 14:27:07,859 - root - INFO - reading file which is of > parquet 
2023-10-14 14:27:07,859 - Ingest - WARNING - load_files method started
2023-10-14 14:27:09,224 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:27:09,225 - root - INFO - displaying file
2023-10-14 14:27:12,664 - root - INFO - validating the dataframe....
2023-10-14 14:27:12,665 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 14:27:13,862 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 14:27:13,863 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 14:27:13,863 - root - INFO - reading file which is of > csv
2023-10-14 14:27:13,864 - Ingest - WARNING - load_files method started
2023-10-14 14:27:23,055 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:27:23,055 - root - INFO - displaying the df_fact dataframe
2023-10-14 14:27:23,575 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 14:27:24,974 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 14:27:24,974 - root - INFO - implementing data_processing methods.....
2023-10-14 14:27:24,974 - Data_processing - WARNING - data_clean method() started....
2023-10-14 14:27:24,975 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 14:27:25,058 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 14:27:25,119 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 14:27:25,140 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 14:27:25,225 - Data_processing - WARNING - concat first and lname 
2023-10-14 14:27:25,262 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 14:27:25,284 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 14:27:26,152 - root - INFO - validating schema for the dataframes.......
2023-10-14 14:27:26,152 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 14:27:26,154 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 14:27:26,154 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 14:27:26,154 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 14:27:26,154 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 14:27:26,154 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 14:27:26,154 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 14:27:26,155 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:27:26,155 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 14:27:26,157 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 14:27:26,158 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 14:27:26,158 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 14:27:26,158 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 14:27:26,159 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 14:27:26,159 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:27:26,159 - root - INFO - Application done
2023-10-14 14:33:54,081 - root - INFO - i am in the main method...
2023-10-14 14:33:54,081 - root - INFO - calling spark object
2023-10-14 14:33:54,082 - root - INFO - get_spark_object method started
2023-10-14 14:33:54,082 - Create_spark - INFO - master is local
2023-10-14 14:34:03,330 - Create_spark - INFO - Spark object created........
2023-10-14 14:34:03,331 - root - INFO - Validating spark object.............
2023-10-14 14:34:03,331 - Validate - WARNING - started the get_current_date method...
2023-10-14 14:34:10,306 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 14:34:10,306 - Validate - WARNING - Validation done , go frwd....
2023-10-14 14:34:10,307 - root - INFO - reading file which is of > parquet 
2023-10-14 14:34:10,307 - Ingest - WARNING - load_files method started
2023-10-14 14:34:11,402 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:34:11,402 - root - INFO - displaying file
2023-10-14 14:34:15,074 - root - INFO - validating the dataframe....
2023-10-14 14:34:15,074 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 14:34:16,006 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 14:34:16,006 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 14:34:16,007 - root - INFO - reading file which is of > csv
2023-10-14 14:34:16,007 - Ingest - WARNING - load_files method started
2023-10-14 14:34:25,542 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:34:25,542 - root - INFO - displaying the df_fact dataframe
2023-10-14 14:34:26,019 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 14:34:27,728 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 14:34:27,728 - root - INFO - implementing data_processing methods.....
2023-10-14 14:34:27,728 - Data_processing - WARNING - data_clean method() started....
2023-10-14 14:34:27,728 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 14:34:27,805 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 14:34:27,843 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 14:34:27,865 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 14:34:27,944 - Data_processing - WARNING - concat first and lname 
2023-10-14 14:34:27,984 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 14:34:28,003 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 14:34:28,318 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 14:34:28,318 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 14:35:10,264 - root - INFO - validating schema for the dataframes.......
2023-10-14 14:35:10,265 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 14:35:10,268 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 14:35:10,268 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 14:35:10,268 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 14:35:10,268 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 14:35:10,268 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 14:35:10,269 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 14:35:10,269 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:35:10,269 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 14:35:10,275 - Validate - INFO - 	StructField('presc_id', LongType(), False)
2023-10-14 14:35:10,275 - Validate - INFO - 	StructField('presc_city', LongType(), False)
2023-10-14 14:35:10,275 - Validate - INFO - 	StructField('presc_state', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('presc_spclt', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('drug_name', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('tx_cnt', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('total_day_supply', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('total_drug_cost', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('years_of_exp', LongType(), False)
2023-10-14 14:35:10,276 - Validate - INFO - 	StructField('Country_name', LongType(), False)
2023-10-14 14:35:10,277 - Validate - INFO - 	StructField('presc_fullname', LongType(), False)
2023-10-14 14:35:10,277 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:35:10,277 - root - INFO - Application done
2023-10-14 14:37:38,836 - root - INFO - i am in the main method...
2023-10-14 14:37:38,837 - root - INFO - calling spark object
2023-10-14 14:37:38,837 - root - INFO - get_spark_object method started
2023-10-14 14:37:38,837 - Create_spark - INFO - master is local
2023-10-14 14:37:48,829 - Create_spark - INFO - Spark object created........
2023-10-14 14:37:48,830 - root - INFO - Validating spark object.............
2023-10-14 14:37:48,830 - Validate - WARNING - started the get_current_date method...
2023-10-14 14:37:56,147 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 14:37:56,148 - Validate - WARNING - Validation done , go frwd....
2023-10-14 14:37:56,149 - root - INFO - reading file which is of > parquet 
2023-10-14 14:37:56,149 - Ingest - WARNING - load_files method started
2023-10-14 14:37:57,978 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:37:57,979 - root - INFO - displaying file
2023-10-14 14:38:07,519 - root - INFO - validating the dataframe....
2023-10-14 14:38:07,520 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 14:38:09,086 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 14:38:09,086 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 14:38:09,086 - root - INFO - reading file which is of > csv
2023-10-14 14:38:09,087 - Ingest - WARNING - load_files method started
2023-10-14 14:38:21,149 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:38:21,149 - root - INFO - displaying the df_fact dataframe
2023-10-14 14:38:21,716 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 14:38:23,197 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 14:38:23,197 - root - INFO - implementing data_processing methods.....
2023-10-14 14:38:23,198 - Data_processing - WARNING - data_clean method() started....
2023-10-14 14:38:23,198 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 14:38:23,300 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 14:38:23,392 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 14:38:23,423 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 14:38:23,503 - Data_processing - WARNING - concat first and lname 
2023-10-14 14:38:23,550 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 14:38:23,575 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 14:38:23,885 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 14:38:23,953 - Data_processing - WARNING - successfully droped the null values....
2023-10-14 14:38:24,264 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 14:39:05,502 - root - INFO - validating schema for the dataframes.......
2023-10-14 14:39:05,502 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 14:39:05,504 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 14:39:05,504 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 14:39:05,504 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 14:39:05,505 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 14:39:05,505 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 14:39:05,505 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 14:39:05,505 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:39:05,505 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 14:39:05,507 - Validate - INFO - 	StructField('presc_id', LongType(), False)
2023-10-14 14:39:05,507 - Validate - INFO - 	StructField('presc_city', LongType(), False)
2023-10-14 14:39:05,507 - Validate - INFO - 	StructField('presc_state', LongType(), False)
2023-10-14 14:39:05,508 - Validate - INFO - 	StructField('presc_spclt', LongType(), False)
2023-10-14 14:39:05,508 - Validate - INFO - 	StructField('drug_name', LongType(), False)
2023-10-14 14:39:05,508 - Validate - INFO - 	StructField('tx_cnt', LongType(), False)
2023-10-14 14:39:05,508 - Validate - INFO - 	StructField('total_day_supply', LongType(), False)
2023-10-14 14:39:05,508 - Validate - INFO - 	StructField('total_drug_cost', LongType(), False)
2023-10-14 14:39:05,508 - Validate - INFO - 	StructField('years_of_exp', LongType(), False)
2023-10-14 14:39:05,509 - Validate - INFO - 	StructField('Country_name', LongType(), False)
2023-10-14 14:39:05,509 - Validate - INFO - 	StructField('presc_fullname', LongType(), False)
2023-10-14 14:39:05,509 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:39:05,509 - root - INFO - Application done
2023-10-14 14:41:37,210 - root - INFO - i am in the main method...
2023-10-14 14:41:37,210 - root - INFO - calling spark object
2023-10-14 14:41:37,210 - root - INFO - get_spark_object method started
2023-10-14 14:41:37,210 - Create_spark - INFO - master is local
2023-10-14 14:41:45,617 - Create_spark - INFO - Spark object created........
2023-10-14 14:41:45,617 - root - INFO - Validating spark object.............
2023-10-14 14:41:45,618 - Validate - WARNING - started the get_current_date method...
2023-10-14 14:41:52,594 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 14:41:52,595 - Validate - WARNING - Validation done , go frwd....
2023-10-14 14:41:52,595 - root - INFO - reading file which is of > parquet 
2023-10-14 14:41:52,595 - Ingest - WARNING - load_files method started
2023-10-14 14:41:53,608 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:41:53,609 - root - INFO - displaying file
2023-10-14 14:41:57,023 - root - INFO - validating the dataframe....
2023-10-14 14:41:57,023 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 14:41:58,100 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 14:41:58,100 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 14:41:58,101 - root - INFO - reading file which is of > csv
2023-10-14 14:41:58,101 - Ingest - WARNING - load_files method started
2023-10-14 14:42:08,068 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:42:08,068 - root - INFO - displaying the df_fact dataframe
2023-10-14 14:42:08,604 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 14:42:09,923 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 14:42:09,923 - root - INFO - implementing data_processing methods.....
2023-10-14 14:42:09,923 - Data_processing - WARNING - data_clean method() started....
2023-10-14 14:42:09,923 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 14:42:09,998 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 14:42:10,038 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 14:42:10,059 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 14:42:10,146 - Data_processing - WARNING - concat first and lname 
2023-10-14 14:42:10,186 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 14:42:10,206 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 14:42:10,499 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 14:42:10,543 - Data_processing - WARNING - successfully droped the null values....
2023-10-14 14:42:10,843 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 14:42:54,397 - root - INFO - validating schema for the dataframes.......
2023-10-14 14:42:54,398 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 14:42:54,400 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 14:42:54,400 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 14:42:54,400 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 14:42:54,400 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 14:42:54,400 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 14:42:54,401 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 14:42:54,401 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:42:54,401 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 14:42:54,402 - Validate - INFO - 	StructField('presc_id', LongType(), False)
2023-10-14 14:42:54,403 - Validate - INFO - 	StructField('presc_city', LongType(), False)
2023-10-14 14:42:54,403 - Validate - INFO - 	StructField('presc_state', LongType(), False)
2023-10-14 14:42:54,403 - Validate - INFO - 	StructField('presc_spclt', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('drug_name', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('tx_cnt', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('total_day_supply', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('total_drug_cost', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('years_of_exp', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('Country_name', LongType(), False)
2023-10-14 14:42:54,404 - Validate - INFO - 	StructField('presc_fullname', LongType(), False)
2023-10-14 14:42:54,405 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:43:36,029 - root - INFO - Application done
2023-10-14 14:55:25,339 - root - INFO - i am in the main method...
2023-10-14 14:55:25,339 - root - INFO - calling spark object
2023-10-14 14:55:25,340 - root - INFO - get_spark_object method started
2023-10-14 14:55:25,340 - Create_spark - INFO - master is local
2023-10-14 14:55:33,828 - Create_spark - INFO - Spark object created........
2023-10-14 14:55:33,828 - root - INFO - Validating spark object.............
2023-10-14 14:55:33,828 - Validate - WARNING - started the get_current_date method...
2023-10-14 14:55:40,877 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 14:55:40,878 - Validate - WARNING - Validation done , go frwd....
2023-10-14 14:55:40,878 - root - INFO - reading file which is of > parquet 
2023-10-14 14:55:40,879 - Ingest - WARNING - load_files method started
2023-10-14 14:55:42,078 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:55:42,078 - root - INFO - displaying file
2023-10-14 14:55:45,969 - root - INFO - validating the dataframe....
2023-10-14 14:55:45,970 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 14:55:47,083 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 14:55:47,083 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 14:55:47,083 - root - INFO - reading file which is of > csv
2023-10-14 14:55:47,084 - Ingest - WARNING - load_files method started
2023-10-14 14:55:56,103 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 14:55:56,103 - root - INFO - displaying the df_fact dataframe
2023-10-14 14:55:56,611 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 14:55:57,998 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 14:55:57,999 - root - INFO - implementing data_processing methods.....
2023-10-14 14:55:57,999 - Data_processing - WARNING - data_clean method() started....
2023-10-14 14:55:57,999 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 14:55:58,078 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 14:55:58,116 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 14:55:58,139 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 14:55:58,224 - Data_processing - WARNING - concat first and lname 
2023-10-14 14:55:58,269 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 14:55:58,292 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 14:55:58,587 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 14:55:58,633 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 14:56:46,603 - root - INFO - validating schema for the dataframes.......
2023-10-14 14:56:46,604 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 14:56:46,606 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 14:56:46,606 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 14:56:46,606 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 14:56:46,606 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 14:56:46,607 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 14:56:46,607 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 14:56:46,607 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:56:46,607 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('presc_id', LongType(), False)
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('presc_city', LongType(), False)
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('presc_state', LongType(), False)
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('presc_spclt', LongType(), False)
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('drug_name', LongType(), False)
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('tx_cnt', LongType(), False)
2023-10-14 14:56:46,610 - Validate - INFO - 	StructField('total_day_supply', LongType(), False)
2023-10-14 14:56:46,611 - Validate - INFO - 	StructField('total_drug_cost', LongType(), False)
2023-10-14 14:56:46,611 - Validate - INFO - 	StructField('years_of_exp', LongType(), False)
2023-10-14 14:56:46,611 - Validate - INFO - 	StructField('Country_name', LongType(), False)
2023-10-14 14:56:46,611 - Validate - INFO - 	StructField('presc_fullname', LongType(), False)
2023-10-14 14:56:46,611 - Validate - INFO - print_schema done, go frwd....
2023-10-14 14:57:28,910 - root - INFO - Application done
2023-10-14 15:00:51,921 - root - INFO - i am in the main method...
2023-10-14 15:00:51,921 - root - INFO - calling spark object
2023-10-14 15:00:51,922 - root - INFO - get_spark_object method started
2023-10-14 15:00:51,922 - Create_spark - INFO - master is local
2023-10-14 15:01:00,356 - Create_spark - INFO - Spark object created........
2023-10-14 15:01:00,356 - root - INFO - Validating spark object.............
2023-10-14 15:01:00,356 - Validate - WARNING - started the get_current_date method...
2023-10-14 15:01:07,757 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 15:01:07,757 - Validate - WARNING - Validation done , go frwd....
2023-10-14 15:01:07,757 - root - INFO - reading file which is of > parquet 
2023-10-14 15:01:07,758 - Ingest - WARNING - load_files method started
2023-10-14 15:01:08,928 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:01:08,929 - root - INFO - displaying file
2023-10-14 15:01:12,709 - root - INFO - validating the dataframe....
2023-10-14 15:01:12,709 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 15:01:13,762 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 15:01:13,763 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 15:01:13,763 - root - INFO - reading file which is of > csv
2023-10-14 15:01:13,764 - Ingest - WARNING - load_files method started
2023-10-14 15:01:23,807 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:01:23,808 - root - INFO - displaying the df_fact dataframe
2023-10-14 15:01:24,323 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 15:01:25,610 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 15:01:25,611 - root - INFO - implementing data_processing methods.....
2023-10-14 15:01:25,611 - Data_processing - WARNING - data_clean method() started....
2023-10-14 15:01:25,611 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 15:01:25,685 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 15:01:25,739 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 15:01:25,764 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 15:01:25,853 - Data_processing - WARNING - concat first and lname 
2023-10-14 15:01:25,902 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 15:01:25,921 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 15:01:25,921 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 15:01:25,964 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 15:01:27,248 - root - INFO - validating schema for the dataframes.......
2023-10-14 15:01:27,248 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 15:01:27,250 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 15:01:27,250 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 15:01:27,250 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 15:01:27,250 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 15:01:27,250 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 15:01:27,250 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 15:01:27,250 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:01:27,250 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 15:01:27,253 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 15:01:27,254 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 15:01:27,254 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 15:01:27,254 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 15:01:27,254 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 15:01:27,254 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:01:27,573 - root - INFO - Application done
2023-10-14 15:02:55,153 - root - INFO - i am in the main method...
2023-10-14 15:02:55,153 - root - INFO - calling spark object
2023-10-14 15:02:55,153 - root - INFO - get_spark_object method started
2023-10-14 15:02:55,153 - Create_spark - INFO - master is local
2023-10-14 15:03:03,636 - Create_spark - INFO - Spark object created........
2023-10-14 15:03:03,636 - root - INFO - Validating spark object.............
2023-10-14 15:03:03,638 - Validate - WARNING - started the get_current_date method...
2023-10-14 15:03:10,861 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 15:03:10,862 - Validate - WARNING - Validation done , go frwd....
2023-10-14 15:03:10,862 - root - INFO - reading file which is of > parquet 
2023-10-14 15:03:10,862 - Ingest - WARNING - load_files method started
2023-10-14 15:03:12,051 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:03:12,051 - root - INFO - displaying file
2023-10-14 15:03:15,736 - root - INFO - validating the dataframe....
2023-10-14 15:03:15,736 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 15:03:16,836 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 15:03:16,837 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 15:03:16,837 - root - INFO - reading file which is of > csv
2023-10-14 15:03:16,838 - Ingest - WARNING - load_files method started
2023-10-14 15:03:25,800 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:03:25,801 - root - INFO - displaying the df_fact dataframe
2023-10-14 15:03:26,327 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 15:03:27,647 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 15:03:27,648 - root - INFO - implementing data_processing methods.....
2023-10-14 15:03:27,648 - Data_processing - WARNING - data_clean method() started....
2023-10-14 15:03:27,648 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 15:03:27,727 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 15:03:27,773 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 15:03:27,796 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 15:03:27,871 - Data_processing - WARNING - concat first and lname 
2023-10-14 15:03:27,907 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 15:03:27,926 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 15:03:27,926 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 15:03:27,966 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 15:03:27,999 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 15:03:28,000 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 15:03:28,000 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 15:03:28,879 - root - INFO - validating schema for the dataframes.......
2023-10-14 15:03:28,879 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 15:03:28,881 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 15:03:28,881 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 15:03:28,881 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 15:03:28,881 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 15:03:28,882 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 15:03:28,882 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 15:03:28,882 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:03:28,882 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 15:03:28,884 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 15:03:28,885 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 15:03:28,886 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 15:03:28,886 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 15:03:28,886 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 15:03:28,886 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:03:29,232 - root - INFO - Application done
2023-10-14 15:04:12,104 - root - INFO - i am in the main method...
2023-10-14 15:04:12,104 - root - INFO - calling spark object
2023-10-14 15:04:12,105 - root - INFO - get_spark_object method started
2023-10-14 15:04:12,105 - Create_spark - INFO - master is local
2023-10-14 15:04:21,408 - Create_spark - INFO - Spark object created........
2023-10-14 15:04:21,408 - root - INFO - Validating spark object.............
2023-10-14 15:04:21,409 - Validate - WARNING - started the get_current_date method...
2023-10-14 15:04:28,381 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 15:04:28,382 - Validate - WARNING - Validation done , go frwd....
2023-10-14 15:04:28,382 - root - INFO - reading file which is of > parquet 
2023-10-14 15:04:28,382 - Ingest - WARNING - load_files method started
2023-10-14 15:04:29,624 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:04:29,624 - root - INFO - displaying file
2023-10-14 15:04:33,359 - root - INFO - validating the dataframe....
2023-10-14 15:04:33,359 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 15:04:34,418 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 15:04:34,418 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 15:04:34,419 - root - INFO - reading file which is of > csv
2023-10-14 15:04:34,419 - Ingest - WARNING - load_files method started
2023-10-14 15:04:44,259 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:04:44,259 - root - INFO - displaying the df_fact dataframe
2023-10-14 15:04:44,754 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 15:04:46,074 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 15:04:46,074 - root - INFO - implementing data_processing methods.....
2023-10-14 15:04:46,074 - Data_processing - WARNING - data_clean method() started....
2023-10-14 15:04:46,075 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 15:04:46,143 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 15:04:46,184 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 15:04:46,206 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 15:04:46,280 - Data_processing - WARNING - concat first and lname 
2023-10-14 15:04:46,329 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 15:04:46,352 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 15:04:46,353 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 15:04:46,393 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 15:04:52,495 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 15:04:52,495 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 15:04:52,495 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 15:04:53,481 - root - INFO - validating schema for the dataframes.......
2023-10-14 15:04:53,481 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 15:04:53,487 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 15:04:53,487 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 15:04:53,487 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 15:04:53,487 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 15:04:53,487 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 15:04:53,488 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 15:04:53,488 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:04:53,488 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 15:04:53,490 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 15:04:53,490 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 15:04:53,490 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 15:04:53,490 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 15:04:53,490 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 15:04:53,491 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 15:04:53,491 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 15:04:53,491 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 15:04:53,491 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 15:04:53,491 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 15:04:53,491 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 15:04:53,492 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:04:53,795 - root - INFO - Application done
2023-10-14 15:12:20,758 - root - INFO - i am in the main method...
2023-10-14 15:12:20,758 - root - INFO - calling spark object
2023-10-14 15:12:20,758 - root - INFO - get_spark_object method started
2023-10-14 15:12:20,759 - Create_spark - INFO - master is local
2023-10-14 15:12:29,887 - Create_spark - INFO - Spark object created........
2023-10-14 15:12:29,887 - root - INFO - Validating spark object.............
2023-10-14 15:12:29,888 - Validate - WARNING - started the get_current_date method...
2023-10-14 15:12:36,890 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 15:12:36,890 - Validate - WARNING - Validation done , go frwd....
2023-10-14 15:12:36,891 - root - INFO - reading file which is of > parquet 
2023-10-14 15:12:36,891 - Ingest - WARNING - load_files method started
2023-10-14 15:12:38,204 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:12:38,205 - root - INFO - displaying file
2023-10-14 15:12:41,903 - root - INFO - validating the dataframe....
2023-10-14 15:12:41,903 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 15:12:42,962 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 15:12:42,963 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 15:12:42,963 - root - INFO - reading file which is of > csv
2023-10-14 15:12:42,964 - Ingest - WARNING - load_files method started
2023-10-14 15:12:52,891 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:12:52,891 - root - INFO - displaying the df_fact dataframe
2023-10-14 15:12:53,435 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 15:12:54,719 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 15:12:54,720 - root - INFO - implementing data_processing methods.....
2023-10-14 15:12:54,720 - Data_processing - WARNING - data_clean method() started....
2023-10-14 15:12:54,720 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 15:12:54,797 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 15:12:54,835 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 15:12:54,860 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 15:12:54,934 - Data_processing - WARNING - concat first and lname 
2023-10-14 15:12:54,980 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 15:12:55,005 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 15:12:55,005 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 15:12:55,053 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 15:13:00,556 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 15:13:00,556 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 15:13:00,557 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 15:13:01,370 - root - INFO - validating schema for the dataframes.......
2023-10-14 15:13:01,371 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 15:13:01,372 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 15:13:01,372 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 15:13:01,373 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 15:13:01,373 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 15:13:01,373 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 15:13:01,373 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 15:13:01,373 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:13:01,373 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 15:13:01,375 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 15:13:01,375 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 15:13:01,375 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 15:13:01,376 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 15:13:01,377 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 15:13:01,377 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:13:01,635 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 15:13:01,636 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 15:14:07,880 - root - INFO - i am in the main method...
2023-10-14 15:14:07,881 - root - INFO - calling spark object
2023-10-14 15:14:07,881 - root - INFO - get_spark_object method started
2023-10-14 15:14:07,881 - Create_spark - INFO - master is local
2023-10-14 15:14:16,800 - Create_spark - INFO - Spark object created........
2023-10-14 15:14:16,800 - root - INFO - Validating spark object.............
2023-10-14 15:14:16,800 - Validate - WARNING - started the get_current_date method...
2023-10-14 15:14:24,042 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 15:14:24,042 - Validate - WARNING - Validation done , go frwd....
2023-10-14 15:14:24,042 - root - INFO - reading file which is of > parquet 
2023-10-14 15:14:24,043 - Ingest - WARNING - load_files method started
2023-10-14 15:14:25,302 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:14:25,302 - root - INFO - displaying file
2023-10-14 15:14:29,159 - root - INFO - validating the dataframe....
2023-10-14 15:14:29,160 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 15:14:30,283 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 15:14:30,283 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 15:14:30,284 - root - INFO - reading file which is of > csv
2023-10-14 15:14:30,284 - Ingest - WARNING - load_files method started
2023-10-14 15:14:39,589 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:14:39,589 - root - INFO - displaying the df_fact dataframe
2023-10-14 15:14:40,104 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 15:14:41,492 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 15:14:41,492 - root - INFO - implementing data_processing methods.....
2023-10-14 15:14:41,492 - Data_processing - WARNING - data_clean method() started....
2023-10-14 15:14:41,492 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 15:14:41,557 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 15:14:41,593 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 15:14:41,616 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 15:14:41,692 - Data_processing - WARNING - concat first and lname 
2023-10-14 15:14:41,739 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 15:14:41,764 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 15:14:41,764 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 15:14:41,810 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 15:14:47,747 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 15:14:47,747 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 15:14:47,747 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 15:14:48,515 - root - INFO - validating schema for the dataframes.......
2023-10-14 15:14:48,515 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 15:14:48,517 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 15:14:48,517 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 15:14:48,518 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 15:14:48,518 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 15:14:48,518 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 15:14:48,518 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 15:14:48,518 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:14:48,518 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 15:14:48,520 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 15:14:48,521 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 15:14:48,522 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 15:14:48,522 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 15:14:48,522 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:14:48,844 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 15:14:48,844 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 15:18:06,510 - root - INFO - i am in the main method...
2023-10-14 15:18:06,510 - root - INFO - calling spark object
2023-10-14 15:18:06,511 - root - INFO - get_spark_object method started
2023-10-14 15:18:06,511 - Create_spark - INFO - master is local
2023-10-14 15:18:15,660 - Create_spark - INFO - Spark object created........
2023-10-14 15:18:15,661 - root - INFO - Validating spark object.............
2023-10-14 15:18:15,661 - Validate - WARNING - started the get_current_date method...
2023-10-14 15:18:22,772 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 15:18:22,772 - Validate - WARNING - Validation done , go frwd....
2023-10-14 15:18:22,774 - root - INFO - reading file which is of > parquet 
2023-10-14 15:18:22,774 - Ingest - WARNING - load_files method started
2023-10-14 15:18:23,851 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:18:23,851 - root - INFO - displaying file
2023-10-14 15:18:27,474 - root - INFO - validating the dataframe....
2023-10-14 15:18:27,474 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 15:18:28,548 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 15:18:28,548 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 15:18:28,549 - root - INFO - reading file which is of > csv
2023-10-14 15:18:28,549 - Ingest - WARNING - load_files method started
2023-10-14 15:18:36,861 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 15:18:36,861 - root - INFO - displaying the df_fact dataframe
2023-10-14 15:18:37,423 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 15:18:38,842 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 15:18:38,843 - root - INFO - implementing data_processing methods.....
2023-10-14 15:18:38,843 - Data_processing - WARNING - data_clean method() started....
2023-10-14 15:18:38,843 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 15:18:38,903 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 15:18:38,941 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 15:18:38,964 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 15:18:39,048 - Data_processing - WARNING - concat first and lname 
2023-10-14 15:18:39,089 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 15:18:39,115 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 15:18:39,115 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 15:18:39,156 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 15:18:44,029 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 15:18:44,029 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 15:18:44,029 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 15:18:44,780 - root - INFO - validating schema for the dataframes.......
2023-10-14 15:18:44,780 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 15:18:44,782 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 15:18:44,782 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 15:18:44,783 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 15:18:44,783 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 15:18:44,783 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 15:18:44,783 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 15:18:44,783 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:18:44,783 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 15:18:44,785 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 15:18:44,785 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 15:18:44,785 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 15:18:44,785 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 15:18:44,786 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 15:18:44,787 - Validate - INFO - print_schema done, go frwd....
2023-10-14 15:18:45,088 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 15:18:45,089 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 15:18:45,437 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 15:19:26,760 - root - INFO - Application done
2023-10-14 16:04:55,199 - root - INFO - i am in the main method...
2023-10-14 16:04:55,199 - root - INFO - calling spark object
2023-10-14 16:04:55,200 - root - INFO - get_spark_object method started
2023-10-14 16:04:55,200 - Create_spark - INFO - master is local
2023-10-14 16:05:03,902 - Create_spark - INFO - Spark object created........
2023-10-14 16:05:03,903 - root - INFO - Validating spark object.............
2023-10-14 16:05:03,903 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:05:10,853 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:05:10,853 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:05:10,853 - root - INFO - reading file which is of > parquet 
2023-10-14 16:05:10,854 - Ingest - WARNING - load_files method started
2023-10-14 16:05:12,001 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:05:12,001 - root - INFO - displaying file
2023-10-14 16:05:15,649 - root - INFO - validating the dataframe....
2023-10-14 16:05:15,649 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:05:16,675 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:05:16,676 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:05:16,676 - root - INFO - reading file which is of > csv
2023-10-14 16:05:16,677 - Ingest - WARNING - load_files method started
2023-10-14 16:05:27,575 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:05:27,575 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:05:28,102 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:05:29,385 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:05:29,385 - root - INFO - implementing data_processing methods.....
2023-10-14 16:05:29,385 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:05:29,385 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:05:29,443 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:05:29,477 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:05:29,496 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:05:29,562 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:05:29,606 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:05:29,630 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:05:29,630 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:05:29,673 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:05:34,506 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:05:34,506 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:05:34,506 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:05:35,237 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:05:35,237 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:05:35,238 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:05:35,239 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:05:35,239 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:05:35,239 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:05:35,239 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:05:35,239 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:05:35,239 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:05:35,239 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:05:35,242 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:05:35,243 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:05:35,546 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:05:35,546 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:05:35,929 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:06:16,613 - root - INFO - data_transformation executing.....
2023-10-14 16:06:16,613 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:06:16,615 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:06:16,687 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:06:16,736 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:06:16,841 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:06:16,842 - root - INFO - displaying the df_report1
2023-10-14 16:06:38,501 - root - INFO - Application done
2023-10-14 16:30:03,870 - root - INFO - i am in the main method...
2023-10-14 16:30:03,872 - root - INFO - calling spark object
2023-10-14 16:30:03,872 - root - INFO - get_spark_object method started
2023-10-14 16:30:03,872 - Create_spark - INFO - master is local
2023-10-14 16:30:12,833 - Create_spark - INFO - Spark object created........
2023-10-14 16:30:12,833 - root - INFO - Validating spark object.............
2023-10-14 16:30:12,834 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:30:20,038 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:30:20,039 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:30:20,039 - root - INFO - reading file which is of > parquet 
2023-10-14 16:30:20,040 - Ingest - WARNING - load_files method started
2023-10-14 16:30:21,259 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:30:21,259 - root - INFO - displaying file
2023-10-14 16:30:25,111 - root - INFO - validating the dataframe....
2023-10-14 16:30:25,112 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:30:26,197 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:30:26,198 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:30:26,198 - root - INFO - reading file which is of > csv
2023-10-14 16:30:26,198 - Ingest - WARNING - load_files method started
2023-10-14 16:30:35,232 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:30:35,233 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:30:35,741 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:30:37,281 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:30:37,281 - root - INFO - implementing data_processing methods.....
2023-10-14 16:30:37,281 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:30:37,281 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:30:37,353 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:30:37,394 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:30:37,419 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:30:37,500 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:30:37,539 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:30:37,561 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:30:37,562 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:30:37,618 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:30:42,769 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:30:42,769 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:30:42,770 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:30:43,522 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:30:43,522 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:30:43,524 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:30:43,524 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:30:43,525 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:30:43,525 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:30:43,525 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:30:43,525 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:30:43,525 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:30:43,525 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:30:43,527 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:30:43,527 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:30:43,527 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:30:43,527 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:30:43,528 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:30:43,528 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:30:43,528 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:30:43,528 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:30:43,528 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:30:43,528 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:30:43,529 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:30:43,529 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:30:43,926 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:30:43,926 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:30:44,260 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:31:24,103 - root - INFO - data_transformation executing.....
2023-10-14 16:31:24,103 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:31:24,106 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:31:24,161 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:31:24,225 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:31:24,341 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:31:24,341 - root - INFO - displaying the df_report1
2023-10-14 16:31:44,244 - root - INFO - displaying data_report2 method....
2023-10-14 16:31:44,245 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 16:31:44,245 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 16:31:44,418 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 16:31:44,418 - root - INFO - displaying the df_report2
2023-10-14 16:31:59,155 - root - INFO - Application done
2023-10-14 16:34:58,394 - root - INFO - i am in the main method...
2023-10-14 16:34:58,394 - root - INFO - calling spark object
2023-10-14 16:34:58,395 - root - INFO - get_spark_object method started
2023-10-14 16:34:58,395 - Create_spark - INFO - master is local
2023-10-14 16:35:07,169 - Create_spark - INFO - Spark object created........
2023-10-14 16:35:07,169 - root - INFO - Validating spark object.............
2023-10-14 16:35:07,170 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:35:14,272 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:35:14,272 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:35:14,273 - root - INFO - reading file which is of > parquet 
2023-10-14 16:35:14,273 - Ingest - WARNING - load_files method started
2023-10-14 16:35:15,524 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:35:15,525 - root - INFO - displaying file
2023-10-14 16:35:19,141 - root - INFO - validating the dataframe....
2023-10-14 16:35:19,141 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:35:20,229 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:35:20,229 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:35:20,230 - root - INFO - reading file which is of > csv
2023-10-14 16:35:20,230 - Ingest - WARNING - load_files method started
2023-10-14 16:35:29,913 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:35:29,913 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:35:30,522 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:35:31,862 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:35:31,862 - root - INFO - implementing data_processing methods.....
2023-10-14 16:35:31,863 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:35:31,863 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:35:31,945 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:35:32,007 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:35:32,031 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:35:32,106 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:35:32,146 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:35:32,166 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:35:32,166 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:35:32,204 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:35:37,332 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:35:37,332 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:35:37,332 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:35:38,154 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:35:38,155 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:35:38,156 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:35:38,156 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:35:38,156 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:35:38,156 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:35:38,156 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:35:38,157 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:35:38,157 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:35:38,157 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:35:38,159 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:35:38,159 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:35:38,508 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:35:38,509 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:35:38,845 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:36:18,705 - root - INFO - data_transformation executing.....
2023-10-14 16:36:18,705 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:36:18,708 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:36:18,773 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:36:18,827 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:36:18,958 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:36:18,958 - root - INFO - displaying the df_report1
2023-10-14 16:36:39,336 - root - INFO - displaying data_report2 method....
2023-10-14 16:36:39,337 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 16:36:39,337 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 16:36:39,506 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 16:36:39,506 - root - INFO - displaying the df_report2
2023-10-14 16:38:06,508 - root - INFO - i am in the main method...
2023-10-14 16:38:06,509 - root - INFO - calling spark object
2023-10-14 16:38:06,509 - root - INFO - get_spark_object method started
2023-10-14 16:38:06,509 - Create_spark - INFO - master is local
2023-10-14 16:38:15,642 - Create_spark - INFO - Spark object created........
2023-10-14 16:38:15,642 - root - INFO - Validating spark object.............
2023-10-14 16:38:15,642 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:38:22,769 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:38:22,770 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:38:22,770 - root - INFO - reading file which is of > parquet 
2023-10-14 16:38:22,770 - Ingest - WARNING - load_files method started
2023-10-14 16:38:23,971 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:38:23,971 - root - INFO - displaying file
2023-10-14 16:38:27,901 - root - INFO - validating the dataframe....
2023-10-14 16:38:27,901 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:38:28,923 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:38:28,923 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:38:28,924 - root - INFO - reading file which is of > csv
2023-10-14 16:38:28,924 - Ingest - WARNING - load_files method started
2023-10-14 16:38:38,719 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:38:38,719 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:38:39,248 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:38:40,597 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:38:40,597 - root - INFO - implementing data_processing methods.....
2023-10-14 16:38:40,598 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:38:40,598 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:38:40,670 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:38:40,707 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:38:40,729 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:38:40,792 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:38:40,830 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:38:40,848 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:38:40,849 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:38:40,888 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:38:46,249 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:38:46,249 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:38:46,249 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:38:47,012 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:38:47,013 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:38:47,019 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:38:47,019 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:38:47,020 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:38:47,020 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:38:47,020 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:38:47,020 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:38:47,020 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:38:47,021 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:38:47,022 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:38:47,023 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:38:47,023 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:38:47,023 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:38:47,024 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:38:47,024 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:38:47,024 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:38:47,024 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:38:47,024 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:38:47,025 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:38:47,025 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:38:47,025 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:38:47,352 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:38:47,353 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:38:47,727 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:39:15,977 - root - INFO - data_transformation executing.....
2023-10-14 16:39:15,977 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:39:15,979 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:39:16,023 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:39:16,064 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:39:16,146 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:39:16,146 - root - INFO - displaying the df_report1
2023-10-14 16:39:29,673 - root - INFO - displaying data_report2 method....
2023-10-14 16:39:29,674 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 16:39:29,674 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 16:39:29,807 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 16:39:29,807 - root - INFO - displaying the df_report2
2023-10-14 16:42:01,901 - root - INFO - i am in the main method...
2023-10-14 16:42:01,901 - root - INFO - calling spark object
2023-10-14 16:42:01,901 - root - INFO - get_spark_object method started
2023-10-14 16:42:01,901 - Create_spark - INFO - master is local
2023-10-14 16:42:07,797 - Create_spark - INFO - Spark object created........
2023-10-14 16:42:07,798 - root - INFO - Validating spark object.............
2023-10-14 16:42:07,798 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:42:12,821 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:42:12,821 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:42:12,822 - root - INFO - reading file which is of > parquet 
2023-10-14 16:42:12,822 - Ingest - WARNING - load_files method started
2023-10-14 16:42:13,637 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:42:13,637 - root - INFO - displaying file
2023-10-14 16:42:16,182 - root - INFO - validating the dataframe....
2023-10-14 16:42:16,182 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:42:16,986 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:42:16,986 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:42:16,987 - root - INFO - reading file which is of > csv
2023-10-14 16:42:16,987 - Ingest - WARNING - load_files method started
2023-10-14 16:42:23,434 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:42:23,434 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:42:23,849 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:42:25,208 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:42:25,208 - root - INFO - implementing data_processing methods.....
2023-10-14 16:42:25,209 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:42:25,209 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:42:25,257 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:42:25,282 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:42:25,300 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:42:25,362 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:42:25,394 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:42:25,421 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:42:25,421 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:42:25,455 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:42:29,202 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:42:29,202 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:42:29,202 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:42:29,804 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:42:29,804 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:42:29,805 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:42:29,806 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:42:29,806 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:42:29,806 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:42:29,806 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:42:29,806 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:42:29,806 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:42:29,806 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:42:29,808 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:42:29,809 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:42:29,809 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:42:29,809 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:42:29,809 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:42:29,809 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:42:30,206 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:42:30,206 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:42:30,396 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:42:57,695 - root - INFO - data_transformation executing.....
2023-10-14 16:42:57,695 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:42:57,697 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:42:57,743 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:42:57,786 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:42:57,851 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:42:57,851 - root - INFO - displaying the df_report1
2023-10-14 16:43:03,952 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=1276>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2023-10-14 16:43:03,958 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.1776.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\pyspark.zip\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\pyspark.zip\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\pyspark.zip\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o14.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2023-10-14 16:43:29,072 - root - INFO - i am in the main method...
2023-10-14 16:43:29,072 - root - INFO - calling spark object
2023-10-14 16:43:29,073 - root - INFO - get_spark_object method started
2023-10-14 16:43:29,073 - Create_spark - INFO - master is local
2023-10-14 16:43:35,397 - Create_spark - INFO - Spark object created........
2023-10-14 16:43:35,397 - root - INFO - Validating spark object.............
2023-10-14 16:43:35,397 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:43:40,292 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:43:40,292 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:43:40,292 - root - INFO - reading file which is of > parquet 
2023-10-14 16:43:40,293 - Ingest - WARNING - load_files method started
2023-10-14 16:43:41,069 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:43:41,069 - root - INFO - displaying file
2023-10-14 16:43:43,511 - root - INFO - validating the dataframe....
2023-10-14 16:43:43,511 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:43:44,380 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:43:44,380 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:43:44,381 - root - INFO - reading file which is of > csv
2023-10-14 16:43:44,381 - Ingest - WARNING - load_files method started
2023-10-14 16:43:50,847 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:43:50,847 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:43:51,254 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:43:52,232 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:43:52,232 - root - INFO - implementing data_processing methods.....
2023-10-14 16:43:52,232 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:43:52,232 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:43:52,292 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:43:52,319 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:43:52,337 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:43:52,391 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:43:52,418 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:43:52,434 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:43:52,434 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:43:52,464 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:43:56,178 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:43:56,178 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:43:56,178 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:43:56,772 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:43:56,772 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:43:56,774 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:43:56,774 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:43:56,774 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:43:56,774 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:43:56,774 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:43:56,774 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:43:56,774 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:43:56,774 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:43:56,776 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:43:56,776 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:43:56,776 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:43:56,776 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:43:56,776 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:43:56,777 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:43:56,777 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:43:56,777 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:43:56,777 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:43:56,777 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:43:56,777 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:43:56,777 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:43:56,967 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:43:56,967 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:43:57,238 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:44:23,556 - root - INFO - data_transformation executing.....
2023-10-14 16:44:23,557 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:44:23,558 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:44:23,601 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:44:23,640 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:44:23,701 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:44:23,702 - root - INFO - displaying the df_report1
2023-10-14 16:44:37,456 - root - INFO - displaying data_report2 method....
2023-10-14 16:44:37,456 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 16:44:37,456 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 16:44:37,595 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 16:44:37,595 - root - INFO - displaying the df_report2
2023-10-14 16:44:47,892 - root - INFO - Application done
2023-10-14 16:46:15,191 - root - INFO - i am in the main method...
2023-10-14 16:46:15,191 - root - INFO - calling spark object
2023-10-14 16:46:15,192 - root - INFO - get_spark_object method started
2023-10-14 16:46:15,192 - Create_spark - INFO - master is local
2023-10-14 16:46:21,146 - Create_spark - INFO - Spark object created........
2023-10-14 16:46:21,146 - root - INFO - Validating spark object.............
2023-10-14 16:46:21,146 - Validate - WARNING - started the get_current_date method...
2023-10-14 16:46:26,106 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 16:46:26,106 - Validate - WARNING - Validation done , go frwd....
2023-10-14 16:46:26,106 - root - INFO - reading file which is of > parquet 
2023-10-14 16:46:26,107 - Ingest - WARNING - load_files method started
2023-10-14 16:46:26,912 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:46:26,912 - root - INFO - displaying file
2023-10-14 16:46:29,333 - root - INFO - validating the dataframe....
2023-10-14 16:46:29,333 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 16:46:30,193 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 16:46:30,193 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 16:46:30,194 - root - INFO - reading file which is of > csv
2023-10-14 16:46:30,194 - Ingest - WARNING - load_files method started
2023-10-14 16:46:36,634 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 16:46:36,635 - root - INFO - displaying the df_fact dataframe
2023-10-14 16:46:37,044 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 16:46:38,004 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 16:46:38,004 - root - INFO - implementing data_processing methods.....
2023-10-14 16:46:38,004 - Data_processing - WARNING - data_clean method() started....
2023-10-14 16:46:38,004 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 16:46:38,054 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 16:46:38,084 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 16:46:38,099 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 16:46:38,155 - Data_processing - WARNING - concat first and lname 
2023-10-14 16:46:38,184 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 16:46:38,202 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 16:46:38,202 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 16:46:38,244 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 16:46:41,870 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 16:46:41,870 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 16:46:41,870 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 16:46:42,485 - root - INFO - validating schema for the dataframes.......
2023-10-14 16:46:42,486 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 16:46:42,487 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 16:46:42,488 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 16:46:42,488 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 16:46:42,488 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 16:46:42,488 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 16:46:42,488 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 16:46:42,488 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:46:42,488 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 16:46:42,490 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 16:46:42,490 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 16:46:42,491 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 16:46:42,491 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 16:46:42,491 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 16:46:42,491 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 16:46:42,492 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 16:46:42,492 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 16:46:42,492 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 16:46:42,492 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 16:46:42,492 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 16:46:42,492 - Validate - INFO - print_schema done, go frwd....
2023-10-14 16:46:42,671 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 16:46:42,672 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 16:46:42,928 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 16:47:08,962 - root - INFO - data_transformation executing.....
2023-10-14 16:47:08,963 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 16:47:08,964 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 16:47:09,017 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 16:47:09,059 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 16:47:09,124 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 16:47:09,124 - root - INFO - displaying the df_report1
2023-10-14 16:47:22,742 - root - INFO - displaying data_report2 method....
2023-10-14 16:47:22,743 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 16:47:22,743 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 16:47:22,866 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 16:47:22,866 - root - INFO - displaying the df_report2
2023-10-14 16:47:33,351 - root - INFO - Application done
2023-10-14 17:19:43,382 - root - INFO - i am in the main method...
2023-10-14 17:19:43,382 - root - INFO - calling spark object
2023-10-14 17:19:43,382 - root - INFO - get_spark_object method started
2023-10-14 17:19:43,382 - Create_spark - INFO - master is local
2023-10-14 17:19:50,176 - Create_spark - INFO - Spark object created........
2023-10-14 17:19:50,177 - root - INFO - Validating spark object.............
2023-10-14 17:19:50,177 - Validate - WARNING - started the get_current_date method...
2023-10-14 17:19:56,072 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 17:19:56,072 - Validate - WARNING - Validation done , go frwd....
2023-10-14 17:19:56,073 - root - INFO - reading file which is of > parquet 
2023-10-14 17:19:56,073 - Ingest - WARNING - load_files method started
2023-10-14 17:19:57,311 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:19:57,311 - root - INFO - displaying file
2023-10-14 17:20:00,414 - root - INFO - validating the dataframe....
2023-10-14 17:20:00,414 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 17:20:01,238 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 17:20:01,238 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 17:20:01,239 - root - INFO - reading file which is of > csv
2023-10-14 17:20:01,239 - Ingest - WARNING - load_files method started
2023-10-14 17:20:07,534 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:20:07,534 - root - INFO - displaying the df_fact dataframe
2023-10-14 17:20:07,931 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 17:20:09,262 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 17:20:09,262 - root - INFO - implementing data_processing methods.....
2023-10-14 17:20:09,262 - Data_processing - WARNING - data_clean method() started....
2023-10-14 17:20:09,262 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 17:20:09,332 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 17:20:09,373 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 17:20:09,395 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 17:20:09,457 - Data_processing - WARNING - concat first and lname 
2023-10-14 17:20:09,487 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 17:20:09,503 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 17:20:09,503 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 17:20:09,535 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 17:20:13,037 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 17:20:13,038 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 17:20:13,038 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 17:20:13,696 - root - INFO - validating schema for the dataframes.......
2023-10-14 17:20:13,696 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 17:20:13,697 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 17:20:13,697 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 17:20:13,697 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 17:20:13,697 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 17:20:13,697 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 17:20:13,697 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 17:20:13,697 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:20:13,697 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 17:20:13,698 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 17:20:13,698 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 17:20:13,699 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 17:20:13,699 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:20:13,871 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 17:20:13,871 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 17:20:14,108 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 17:20:40,455 - root - INFO - data_transformation executing.....
2023-10-14 17:20:40,455 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 17:20:40,456 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 17:20:40,504 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 17:20:40,546 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 17:20:40,620 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 17:20:40,620 - root - INFO - displaying the df_report1
2023-10-14 17:20:53,827 - root - INFO - displaying data_report2 method....
2023-10-14 17:20:53,828 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 17:20:53,828 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 17:20:53,969 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 17:20:53,969 - root - INFO - displaying the df_report2
2023-10-14 17:21:04,521 - root - INFO - extracting files to Output....
2023-10-14 17:21:04,522 - Extraction - WARNING - extract_files method started executing......
2023-10-14 17:27:07,553 - root - INFO - i am in the main method...
2023-10-14 17:27:07,554 - root - INFO - calling spark object
2023-10-14 17:27:07,555 - root - INFO - get_spark_object method started
2023-10-14 17:27:07,556 - Create_spark - INFO - master is local
2023-10-14 17:27:13,506 - Create_spark - INFO - Spark object created........
2023-10-14 17:27:13,506 - root - INFO - Validating spark object.............
2023-10-14 17:27:13,506 - Validate - WARNING - started the get_current_date method...
2023-10-14 17:27:18,420 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 17:27:18,420 - Validate - WARNING - Validation done , go frwd....
2023-10-14 17:27:18,420 - root - INFO - reading file which is of > parquet 
2023-10-14 17:27:18,420 - Ingest - WARNING - load_files method started
2023-10-14 17:27:19,312 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:27:19,312 - root - INFO - displaying file
2023-10-14 17:27:21,883 - root - INFO - validating the dataframe....
2023-10-14 17:27:21,883 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 17:27:22,683 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 17:27:22,683 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 17:27:22,684 - root - INFO - reading file which is of > csv
2023-10-14 17:27:22,684 - Ingest - WARNING - load_files method started
2023-10-14 17:27:29,070 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:27:29,070 - root - INFO - displaying the df_fact dataframe
2023-10-14 17:27:29,492 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 17:27:30,586 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 17:27:30,586 - root - INFO - implementing data_processing methods.....
2023-10-14 17:27:30,586 - Data_processing - WARNING - data_clean method() started....
2023-10-14 17:27:30,586 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 17:27:30,634 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 17:27:30,663 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 17:27:30,678 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 17:27:30,731 - Data_processing - WARNING - concat first and lname 
2023-10-14 17:27:30,759 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 17:27:30,774 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 17:27:30,774 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 17:27:30,805 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 17:27:34,510 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 17:27:34,510 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 17:27:34,510 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 17:27:35,113 - root - INFO - validating schema for the dataframes.......
2023-10-14 17:27:35,114 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 17:27:35,115 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 17:27:35,116 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 17:27:35,116 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 17:27:35,116 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 17:27:35,116 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 17:27:35,116 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 17:27:35,116 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:27:35,116 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 17:27:35,118 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 17:27:35,119 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 17:27:35,119 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 17:27:35,119 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 17:27:35,119 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:27:35,308 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 17:27:35,308 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 17:27:35,584 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 17:28:01,928 - root - INFO - data_transformation executing.....
2023-10-14 17:28:01,929 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 17:28:01,932 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 17:28:01,981 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 17:28:02,024 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 17:28:02,091 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 17:28:02,091 - root - INFO - displaying the df_report1
2023-10-14 17:28:15,415 - root - INFO - displaying data_report2 method....
2023-10-14 17:28:15,416 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 17:28:15,416 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 17:28:15,541 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 17:28:15,541 - root - INFO - displaying the df_report2
2023-10-14 17:28:25,745 - root - INFO - extracting files to Output....
2023-10-14 17:28:25,745 - Extraction - WARNING - extract_files method started executing......
2023-10-14 17:40:08,078 - root - INFO - i am in the main method...
2023-10-14 17:40:08,078 - root - INFO - calling spark object
2023-10-14 17:40:08,078 - root - INFO - get_spark_object method started
2023-10-14 17:40:08,078 - Create_spark - INFO - master is local
2023-10-14 17:40:14,192 - Create_spark - INFO - Spark object created........
2023-10-14 17:40:14,193 - root - INFO - Validating spark object.............
2023-10-14 17:40:14,193 - Validate - WARNING - started the get_current_date method...
2023-10-14 17:40:19,514 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 17:40:19,515 - Validate - WARNING - Validation done , go frwd....
2023-10-14 17:40:19,515 - root - INFO - reading file which is of > parquet 
2023-10-14 17:40:19,515 - Ingest - WARNING - load_files method started
2023-10-14 17:40:20,380 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:40:20,380 - root - INFO - displaying file
2023-10-14 17:40:22,903 - root - INFO - validating the dataframe....
2023-10-14 17:40:22,903 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 17:40:23,752 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 17:40:23,752 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 17:40:23,753 - root - INFO - reading file which is of > csv
2023-10-14 17:40:23,753 - Ingest - WARNING - load_files method started
2023-10-14 17:40:30,898 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:40:30,898 - root - INFO - displaying the df_fact dataframe
2023-10-14 17:40:31,306 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 17:40:32,364 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 17:40:32,364 - root - INFO - implementing data_processing methods.....
2023-10-14 17:40:32,364 - Data_processing - WARNING - data_clean method() started....
2023-10-14 17:40:32,364 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 17:40:32,439 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 17:40:32,459 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 17:40:32,473 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 17:40:32,520 - Data_processing - WARNING - concat first and lname 
2023-10-14 17:40:32,547 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 17:40:32,564 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 17:40:32,564 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 17:40:32,600 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 17:40:36,233 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 17:40:36,234 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 17:40:36,234 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 17:40:36,788 - root - INFO - validating schema for the dataframes.......
2023-10-14 17:40:36,788 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 17:40:36,789 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 17:40:36,789 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 17:40:36,789 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 17:40:36,789 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 17:40:36,789 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 17:40:36,790 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 17:40:36,790 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:40:36,790 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 17:40:36,791 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 17:40:36,792 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 17:40:36,792 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 17:40:36,792 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 17:40:36,792 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:40:36,959 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 17:40:36,960 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 17:40:37,228 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 17:41:03,817 - root - INFO - data_transformation executing.....
2023-10-14 17:41:03,817 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 17:41:03,818 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 17:41:03,866 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 17:41:03,902 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 17:41:03,969 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 17:41:03,970 - root - INFO - displaying the df_report1
2023-10-14 17:41:18,084 - root - INFO - displaying data_report2 method....
2023-10-14 17:41:18,084 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 17:41:18,085 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 17:41:18,212 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 17:41:18,212 - root - INFO - displaying the df_report2
2023-10-14 17:41:28,899 - root - INFO - extracting files to Output....
2023-10-14 17:41:28,899 - Extraction - WARNING - extract_files method started executing....
2023-10-14 17:45:08,741 - root - INFO - i am in the main method...
2023-10-14 17:45:08,741 - root - INFO - calling spark object
2023-10-14 17:45:08,741 - root - INFO - get_spark_object method started
2023-10-14 17:45:08,741 - Create_spark - INFO - master is local
2023-10-14 17:45:22,083 - Create_spark - INFO - Spark object created........
2023-10-14 17:45:22,083 - root - INFO - Validating spark object.............
2023-10-14 17:45:22,083 - Validate - WARNING - started the get_current_date method...
2023-10-14 17:45:28,761 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 17:45:28,761 - Validate - WARNING - Validation done , go frwd....
2023-10-14 17:45:28,761 - root - INFO - reading file which is of > parquet 
2023-10-14 17:45:28,761 - Ingest - WARNING - load_files method started
2023-10-14 17:45:29,625 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:45:29,625 - root - INFO - displaying file
2023-10-14 17:45:32,316 - root - INFO - validating the dataframe....
2023-10-14 17:45:32,316 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 17:45:33,188 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 17:45:33,188 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 17:45:33,188 - root - INFO - reading file which is of > csv
2023-10-14 17:45:33,189 - Ingest - WARNING - load_files method started
2023-10-14 17:45:40,912 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 17:45:40,912 - root - INFO - displaying the df_fact dataframe
2023-10-14 17:45:41,330 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 17:45:42,416 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 17:45:42,417 - root - INFO - implementing data_processing methods.....
2023-10-14 17:45:42,417 - Data_processing - WARNING - data_clean method() started....
2023-10-14 17:45:42,417 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 17:45:42,475 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 17:45:42,508 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 17:45:42,525 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 17:45:42,580 - Data_processing - WARNING - concat first and lname 
2023-10-14 17:45:42,609 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 17:45:42,626 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 17:45:42,626 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 17:45:42,658 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 17:45:46,491 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 17:45:46,492 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 17:45:46,492 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 17:45:47,103 - root - INFO - validating schema for the dataframes.......
2023-10-14 17:45:47,103 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 17:45:47,104 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 17:45:47,105 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 17:45:47,105 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 17:45:47,105 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 17:45:47,105 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 17:45:47,105 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 17:45:47,105 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:45:47,105 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 17:45:47,108 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 17:45:47,109 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 17:45:47,109 - Validate - INFO - print_schema done, go frwd....
2023-10-14 17:45:47,307 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 17:45:47,307 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 17:45:47,616 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 17:46:13,692 - root - INFO - data_transformation executing.....
2023-10-14 17:46:13,692 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 17:46:13,696 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 17:46:13,752 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 17:46:13,792 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 17:46:13,867 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 17:46:13,867 - root - INFO - displaying the df_report1
2023-10-14 17:46:27,339 - root - INFO - displaying data_report2 method....
2023-10-14 17:46:27,339 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 17:46:27,339 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 17:46:27,452 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 17:46:27,452 - root - INFO - displaying the df_report2
2023-10-14 17:46:39,674 - root - INFO - extracting files to Output....
2023-10-14 18:02:13,305 - root - INFO - i am in the main method...
2023-10-14 18:02:13,305 - root - INFO - calling spark object
2023-10-14 18:02:13,306 - root - INFO - get_spark_object method started
2023-10-14 18:02:13,306 - Create_spark - INFO - master is local
2023-10-14 18:02:20,664 - Create_spark - INFO - Spark object created........
2023-10-14 18:02:20,664 - root - INFO - Validating spark object.............
2023-10-14 18:02:20,664 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:02:26,975 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:02:26,975 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:02:26,975 - root - INFO - reading file which is of > parquet 
2023-10-14 18:02:26,976 - Ingest - WARNING - load_files method started
2023-10-14 18:02:27,840 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:02:27,841 - root - INFO - displaying file
2023-10-14 18:02:30,893 - root - INFO - validating the dataframe....
2023-10-14 18:02:30,893 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:02:31,699 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:02:31,699 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:02:31,699 - root - INFO - reading file which is of > csv
2023-10-14 18:02:31,699 - Ingest - WARNING - load_files method started
2023-10-14 18:02:38,418 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:02:38,418 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:02:38,816 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:02:39,814 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:02:39,814 - root - INFO - implementing data_processing methods.....
2023-10-14 18:02:39,814 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:02:39,815 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:02:39,862 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:02:39,885 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:02:39,903 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:02:39,951 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:02:39,978 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:02:39,993 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:02:39,993 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:02:40,027 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:02:43,734 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:02:43,734 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:02:43,734 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:02:44,437 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:02:44,437 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:02:44,439 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:02:44,439 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:02:44,439 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:02:44,439 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:02:44,439 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:02:44,439 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:02:44,439 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:02:44,439 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:02:44,440 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:02:44,440 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:02:44,728 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:02:44,728 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:02:45,121 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:03:11,426 - root - INFO - data_transformation executing.....
2023-10-14 18:03:11,426 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:03:11,427 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:03:11,470 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:03:11,511 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:03:11,581 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:03:11,581 - root - INFO - displaying the df_report1
2023-10-14 18:03:25,386 - root - INFO - displaying data_report2 method....
2023-10-14 18:03:25,386 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:03:25,387 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:03:25,574 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:03:25,574 - root - INFO - displaying the df_report2
2023-10-14 18:03:40,453 - root - INFO - extracting files to Output....
2023-10-14 18:09:01,690 - root - INFO - i am in the main method...
2023-10-14 18:09:01,690 - root - INFO - calling spark object
2023-10-14 18:09:01,690 - root - INFO - get_spark_object method started
2023-10-14 18:09:01,691 - Create_spark - INFO - master is local
2023-10-14 18:09:09,103 - Create_spark - INFO - Spark object created........
2023-10-14 18:09:09,103 - root - INFO - Validating spark object.............
2023-10-14 18:09:09,103 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:09:15,829 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:09:15,829 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:09:15,830 - root - INFO - reading file which is of > parquet 
2023-10-14 18:09:15,830 - Ingest - WARNING - load_files method started
2023-10-14 18:09:16,748 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:09:16,748 - root - INFO - displaying file
2023-10-14 18:09:20,152 - root - INFO - validating the dataframe....
2023-10-14 18:09:20,153 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:09:21,052 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:09:21,053 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:09:21,054 - root - INFO - reading file which is of > csv
2023-10-14 18:09:21,055 - Ingest - WARNING - load_files method started
2023-10-14 18:09:29,297 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:09:29,297 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:09:29,758 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:09:31,051 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:09:31,051 - root - INFO - implementing data_processing methods.....
2023-10-14 18:09:31,052 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:09:31,052 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:09:31,108 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:09:31,145 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:09:31,163 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:09:31,224 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:09:31,264 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:09:31,300 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:09:31,300 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:09:31,348 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:09:36,174 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:09:36,174 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:09:36,174 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:09:36,841 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:09:36,841 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:09:36,843 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:09:36,843 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:09:36,843 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:09:36,844 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:09:36,844 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:09:36,844 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:09:36,844 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:09:36,844 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:09:36,847 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:09:36,847 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:09:36,847 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:09:36,847 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:09:36,847 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:09:36,847 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:09:36,848 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:09:36,848 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:09:36,848 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:09:36,848 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:09:36,848 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:09:36,848 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:09:37,073 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:09:37,073 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:09:37,432 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:10:07,691 - root - INFO - data_transformation executing.....
2023-10-14 18:10:07,691 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:10:07,693 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:10:07,764 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:10:07,802 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:10:07,883 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:10:07,883 - root - INFO - displaying the df_report1
2023-10-14 18:10:22,682 - root - INFO - displaying data_report2 method....
2023-10-14 18:10:22,682 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:10:22,682 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:10:22,852 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:10:22,853 - root - INFO - displaying the df_report2
2023-10-14 18:10:34,289 - root - INFO - extracting files to Output....
2023-10-14 18:12:20,771 - root - INFO - i am in the main method...
2023-10-14 18:12:20,771 - root - INFO - calling spark object
2023-10-14 18:12:20,771 - root - INFO - get_spark_object method started
2023-10-14 18:12:20,771 - Create_spark - INFO - master is local
2023-10-14 18:12:27,891 - Create_spark - INFO - Spark object created........
2023-10-14 18:12:27,891 - root - INFO - Validating spark object.............
2023-10-14 18:12:27,892 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:12:33,944 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:12:33,944 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:12:33,944 - root - INFO - reading file which is of > parquet 
2023-10-14 18:12:33,944 - Ingest - WARNING - load_files method started
2023-10-14 18:12:34,975 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:12:34,975 - root - INFO - displaying file
2023-10-14 18:12:39,507 - root - INFO - validating the dataframe....
2023-10-14 18:12:39,507 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:12:41,221 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:12:41,221 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:12:41,222 - root - INFO - reading file which is of > csv
2023-10-14 18:12:41,222 - Ingest - WARNING - load_files method started
2023-10-14 18:12:51,948 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:12:51,948 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:12:52,724 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:12:55,066 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:12:55,066 - root - INFO - implementing data_processing methods.....
2023-10-14 18:12:55,066 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:12:55,067 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:12:55,148 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:12:55,193 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:12:55,208 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:12:55,293 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:12:55,334 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:12:55,357 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:12:55,357 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:12:55,396 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:13:02,855 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:13:02,856 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:13:02,856 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:13:03,947 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:13:03,947 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:13:03,977 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:13:03,978 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:13:03,978 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:13:03,978 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:13:03,978 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:13:03,978 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:13:03,978 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:13:03,979 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:13:03,980 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:13:03,980 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:13:03,980 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:13:03,981 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:13:03,981 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:13:04,374 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:13:04,374 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:13:04,680 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:13:40,134 - root - INFO - data_transformation executing.....
2023-10-14 18:13:40,135 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:13:40,142 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:13:40,211 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:13:40,267 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:13:40,371 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:13:40,371 - root - INFO - displaying the df_report1
2023-10-14 18:13:56,981 - root - INFO - displaying data_report2 method....
2023-10-14 18:13:56,981 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:13:56,981 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:13:57,145 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:13:57,145 - root - INFO - displaying the df_report2
2023-10-14 18:14:10,315 - root - INFO - extracting files to Output....
2023-10-14 18:14:10,315 - root - INFO - extracting files to Output completed....
2023-10-14 18:14:10,316 - root - INFO - Application done
2023-10-14 18:17:20,704 - root - INFO - i am in the main method...
2023-10-14 18:17:20,705 - root - INFO - calling spark object
2023-10-14 18:17:20,705 - root - INFO - get_spark_object method started
2023-10-14 18:17:20,705 - Create_spark - INFO - master is local
2023-10-14 18:17:27,661 - Create_spark - INFO - Spark object created........
2023-10-14 18:17:27,661 - root - INFO - Validating spark object.............
2023-10-14 18:17:27,661 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:17:34,333 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:17:34,334 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:17:34,334 - root - INFO - reading file which is of > parquet 
2023-10-14 18:17:34,334 - Ingest - WARNING - load_files method started
2023-10-14 18:17:35,414 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:17:35,414 - root - INFO - displaying file
2023-10-14 18:17:38,609 - root - INFO - validating the dataframe....
2023-10-14 18:17:38,609 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:17:39,470 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:17:39,470 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:17:39,470 - root - INFO - reading file which is of > csv
2023-10-14 18:17:39,470 - Ingest - WARNING - load_files method started
2023-10-14 18:17:46,057 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:17:46,057 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:17:46,499 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:17:47,508 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:17:47,508 - root - INFO - implementing data_processing methods.....
2023-10-14 18:17:47,508 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:17:47,508 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:17:47,560 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:17:47,587 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:17:47,604 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:17:47,672 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:17:47,695 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:17:47,715 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:17:47,716 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:17:47,745 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:17:51,527 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:17:51,527 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:17:51,527 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:17:52,231 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:17:52,232 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:17:52,233 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:17:52,233 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:17:52,233 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:17:52,233 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:17:52,233 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:17:52,233 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:17:52,233 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:17:52,234 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:17:52,235 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:17:52,236 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:17:52,236 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:17:52,415 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:17:52,415 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:17:52,745 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:18:20,747 - root - INFO - data_transformation executing.....
2023-10-14 18:18:20,747 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:18:20,748 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:18:20,798 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:18:20,840 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:18:20,906 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:18:20,906 - root - INFO - displaying the df_report1
2023-10-14 18:18:35,367 - root - INFO - displaying data_report2 method....
2023-10-14 18:18:35,367 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:18:35,367 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:18:35,521 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:18:35,521 - root - INFO - displaying the df_report2
2023-10-14 18:18:45,953 - root - INFO - extracting files to Output....
2023-10-14 18:19:52,004 - root - INFO - i am in the main method...
2023-10-14 18:19:52,004 - root - INFO - calling spark object
2023-10-14 18:19:52,004 - root - INFO - get_spark_object method started
2023-10-14 18:19:52,004 - Create_spark - INFO - master is local
2023-10-14 18:19:58,408 - Create_spark - INFO - Spark object created........
2023-10-14 18:19:58,408 - root - INFO - Validating spark object.............
2023-10-14 18:19:58,408 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:20:04,313 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:20:04,314 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:20:04,340 - root - INFO - reading file which is of > parquet 
2023-10-14 18:20:04,340 - Ingest - WARNING - load_files method started
2023-10-14 18:20:05,110 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:20:05,110 - root - INFO - displaying file
2023-10-14 18:20:07,513 - root - INFO - validating the dataframe....
2023-10-14 18:20:07,513 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:20:08,319 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:20:08,319 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:20:08,319 - root - INFO - reading file which is of > csv
2023-10-14 18:20:08,320 - Ingest - WARNING - load_files method started
2023-10-14 18:20:14,887 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:20:14,887 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:20:15,265 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:20:16,299 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:20:16,300 - root - INFO - implementing data_processing methods.....
2023-10-14 18:20:16,300 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:20:16,300 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:20:16,352 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:20:16,381 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:20:16,398 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:20:16,447 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:20:16,475 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:20:16,489 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:20:16,489 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:20:16,517 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:20:20,212 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:20:20,213 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:20:20,213 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:20:20,789 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:20:20,789 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:20:20,790 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:20:20,791 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:20:20,791 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:20:20,791 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:20:20,791 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:20:20,791 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:20:20,791 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:20:20,791 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:20:20,793 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:20:20,794 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:20:20,794 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:20:20,794 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:20:20,794 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:20:20,975 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:20:20,975 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:20:21,227 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:20:47,479 - root - INFO - data_transformation executing.....
2023-10-14 18:20:47,480 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:20:47,481 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:20:47,527 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:20:47,568 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:20:47,636 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:20:47,636 - root - INFO - displaying the df_report1
2023-10-14 18:21:01,470 - root - INFO - displaying data_report2 method....
2023-10-14 18:21:01,470 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:21:01,470 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:21:01,592 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:21:01,593 - root - INFO - displaying the df_report2
2023-10-14 18:21:11,252 - root - INFO - extracting files to Output....
2023-10-14 18:21:11,253 - Extraction - WARNING - extract_files method started executing....
2023-10-14 18:26:35,444 - root - INFO - i am in the main method...
2023-10-14 18:26:35,444 - root - INFO - calling spark object
2023-10-14 18:26:35,444 - root - INFO - get_spark_object method started
2023-10-14 18:26:35,444 - Create_spark - INFO - master is local
2023-10-14 18:26:41,627 - Create_spark - INFO - Spark object created........
2023-10-14 18:26:41,627 - root - INFO - Validating spark object.............
2023-10-14 18:26:41,627 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:26:46,509 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:26:46,509 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:26:46,509 - root - INFO - reading file which is of > parquet 
2023-10-14 18:26:46,509 - Ingest - WARNING - load_files method started
2023-10-14 18:26:47,416 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:26:47,416 - root - INFO - displaying file
2023-10-14 18:26:50,229 - root - INFO - validating the dataframe....
2023-10-14 18:26:50,229 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:26:51,096 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:26:51,096 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:26:51,096 - root - INFO - reading file which is of > csv
2023-10-14 18:26:51,097 - Ingest - WARNING - load_files method started
2023-10-14 18:26:58,566 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:26:58,566 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:26:58,988 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:27:00,094 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:27:00,094 - root - INFO - implementing data_processing methods.....
2023-10-14 18:27:00,094 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:27:00,094 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:27:00,157 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:27:00,194 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:27:00,207 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:27:00,254 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:27:00,279 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:27:00,300 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:27:00,300 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:27:00,331 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:27:04,242 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:27:04,242 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:27:04,242 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:27:04,812 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:27:04,812 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:27:04,814 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:27:04,814 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:27:04,814 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:27:04,814 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:27:04,814 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:27:04,814 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:27:04,814 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:27:04,814 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:27:04,817 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:27:04,817 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:27:04,817 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:27:04,817 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:27:04,817 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:27:04,817 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:27:04,818 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:27:04,818 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:27:04,818 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:27:04,818 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:27:04,818 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:27:04,818 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:27:04,999 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:27:04,999 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:27:05,281 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:27:32,816 - root - INFO - data_transformation executing.....
2023-10-14 18:27:32,816 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:27:32,817 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:27:32,873 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:27:32,916 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:27:32,989 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:27:32,989 - root - INFO - displaying the df_report1
2023-10-14 18:27:47,563 - root - INFO - displaying data_report2 method....
2023-10-14 18:27:47,563 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:27:47,564 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:27:47,928 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:27:47,931 - root - INFO - displaying the df_report2
2023-10-14 18:27:58,896 - root - INFO - extracting files to Output....
2023-10-14 18:28:47,335 - root - INFO - i am in the main method...
2023-10-14 18:28:47,335 - root - INFO - calling spark object
2023-10-14 18:28:47,335 - root - INFO - get_spark_object method started
2023-10-14 18:28:47,335 - Create_spark - INFO - master is local
2023-10-14 18:28:53,830 - Create_spark - INFO - Spark object created........
2023-10-14 18:28:53,830 - root - INFO - Validating spark object.............
2023-10-14 18:28:53,830 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:28:59,012 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:28:59,013 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:28:59,013 - root - INFO - reading file which is of > parquet 
2023-10-14 18:28:59,013 - Ingest - WARNING - load_files method started
2023-10-14 18:28:59,840 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:28:59,840 - root - INFO - displaying file
2023-10-14 18:29:02,418 - root - INFO - validating the dataframe....
2023-10-14 18:29:02,418 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:29:03,280 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:29:03,280 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:29:03,281 - root - INFO - reading file which is of > csv
2023-10-14 18:29:03,281 - Ingest - WARNING - load_files method started
2023-10-14 18:29:09,904 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:29:09,904 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:29:10,310 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:29:11,301 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:29:11,301 - root - INFO - implementing data_processing methods.....
2023-10-14 18:29:11,301 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:29:11,301 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:29:11,357 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:29:11,387 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:29:11,405 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:29:11,458 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:29:11,489 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:29:11,504 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:29:11,505 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:29:11,541 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:29:15,266 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:29:15,267 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:29:15,267 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:29:15,852 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:29:15,852 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:29:15,853 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:29:15,853 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:29:15,853 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:29:15,854 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:29:15,854 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:29:15,854 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:29:15,854 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:29:15,854 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:29:15,856 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:29:15,856 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:29:15,856 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:29:15,857 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:29:15,857 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:29:15,857 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:29:15,857 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:29:15,858 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:29:15,858 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:29:15,858 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:29:15,859 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:29:15,859 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:29:16,030 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:29:16,031 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:29:16,348 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:29:43,281 - root - INFO - data_transformation executing.....
2023-10-14 18:29:43,281 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:29:43,282 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:29:43,328 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:29:43,369 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:29:43,451 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:29:43,451 - root - INFO - displaying the df_report1
2023-10-14 18:29:56,738 - root - INFO - displaying data_report2 method....
2023-10-14 18:29:56,738 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:29:56,739 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:29:56,853 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:29:56,853 - root - INFO - displaying the df_report2
2023-10-14 18:30:07,282 - root - INFO - extracting files to Output....
2023-10-14 18:34:06,864 - root - INFO - i am in the main method...
2023-10-14 18:34:06,864 - root - INFO - calling spark object
2023-10-14 18:34:06,865 - root - INFO - get_spark_object method started
2023-10-14 18:34:06,865 - Create_spark - INFO - master is local
2023-10-14 18:34:13,142 - Create_spark - INFO - Spark object created........
2023-10-14 18:34:13,142 - root - INFO - Validating spark object.............
2023-10-14 18:34:13,142 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:34:18,900 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:34:18,900 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:34:18,901 - root - INFO - reading file which is of > parquet 
2023-10-14 18:34:18,901 - Ingest - WARNING - load_files method started
2023-10-14 18:34:19,811 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:34:19,812 - root - INFO - displaying file
2023-10-14 18:34:20,312 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=1224>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2023-10-14 18:34:20,317 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.1776.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\pyspark.zip\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\pyspark.zip\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\pyspark.zip\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o14.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Spark\spark-3.5.0-bin-hadoop3\python\lib\py4j-0.10.9.7-src.zip\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2023-10-14 18:34:30,288 - root - INFO - i am in the main method...
2023-10-14 18:34:30,289 - root - INFO - calling spark object
2023-10-14 18:34:30,289 - root - INFO - get_spark_object method started
2023-10-14 18:34:30,289 - Create_spark - INFO - master is local
2023-10-14 18:34:36,951 - Create_spark - INFO - Spark object created........
2023-10-14 18:34:36,951 - root - INFO - Validating spark object.............
2023-10-14 18:34:36,951 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:34:41,987 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:34:41,987 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:34:41,987 - root - INFO - reading file which is of > parquet 
2023-10-14 18:34:41,987 - Ingest - WARNING - load_files method started
2023-10-14 18:34:42,749 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:34:42,749 - root - INFO - displaying file
2023-10-14 18:34:45,360 - root - INFO - validating the dataframe....
2023-10-14 18:34:45,360 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:34:46,180 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:34:46,180 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:34:46,180 - root - INFO - reading file which is of > csv
2023-10-14 18:34:46,180 - Ingest - WARNING - load_files method started
2023-10-14 18:34:53,120 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:34:53,120 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:34:53,539 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:34:54,587 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:34:54,587 - root - INFO - implementing data_processing methods.....
2023-10-14 18:34:54,587 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:34:54,587 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:34:54,643 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:34:54,695 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:34:54,721 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:34:54,785 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:34:54,812 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:34:54,828 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:34:54,828 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:34:54,859 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:34:59,625 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:34:59,626 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:34:59,626 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:35:00,290 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:35:00,290 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:35:00,292 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:35:00,292 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:35:00,292 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:35:00,292 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:35:00,292 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:35:00,292 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:35:00,292 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:35:00,292 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:35:00,294 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:35:00,294 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:35:00,484 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:35:00,484 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:35:00,779 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:35:27,866 - root - INFO - data_transformation executing.....
2023-10-14 18:35:27,866 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:35:27,867 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:35:27,911 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:35:27,953 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:35:28,023 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:35:28,023 - root - INFO - displaying the df_report1
2023-10-14 18:35:41,276 - root - INFO - displaying data_report2 method....
2023-10-14 18:35:41,276 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:35:41,276 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:35:41,410 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:35:41,410 - root - INFO - displaying the df_report2
2023-10-14 18:35:51,609 - root - INFO - extracting files to Output....
2023-10-14 18:38:25,935 - root - INFO - i am in the main method...
2023-10-14 18:38:25,935 - root - INFO - calling spark object
2023-10-14 18:38:25,935 - root - INFO - get_spark_object method started
2023-10-14 18:38:25,935 - Create_spark - INFO - master is local
2023-10-14 18:38:32,217 - Create_spark - INFO - Spark object created........
2023-10-14 18:38:32,217 - root - INFO - Validating spark object.............
2023-10-14 18:38:32,217 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:38:37,952 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:38:37,952 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:38:37,953 - root - INFO - reading file which is of > parquet 
2023-10-14 18:38:37,953 - Ingest - WARNING - load_files method started
2023-10-14 18:38:38,754 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:38:38,754 - root - INFO - displaying file
2023-10-14 18:38:41,160 - root - INFO - validating the dataframe....
2023-10-14 18:38:41,160 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:38:42,186 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:38:42,186 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:38:42,187 - root - INFO - reading file which is of > csv
2023-10-14 18:38:42,187 - Ingest - WARNING - load_files method started
2023-10-14 18:38:48,689 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:38:48,689 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:38:49,105 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:38:50,195 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:38:50,195 - root - INFO - implementing data_processing methods.....
2023-10-14 18:38:50,195 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:38:50,195 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:38:50,247 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:38:50,276 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:38:50,299 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:38:50,364 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:38:50,394 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:38:50,409 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:38:50,409 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:38:50,438 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:38:54,113 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:38:54,113 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:38:54,113 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:38:54,665 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:38:54,665 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:38:54,667 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:38:54,667 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:38:54,668 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:38:54,668 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:38:54,668 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:38:54,668 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:38:54,668 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:38:54,668 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:38:54,669 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:38:54,670 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:38:54,671 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:38:54,671 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:38:54,860 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:38:54,860 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:38:55,099 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:39:22,734 - root - INFO - data_transformation executing.....
2023-10-14 18:39:22,734 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:39:22,735 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:39:22,778 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:39:22,818 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:39:22,884 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:39:22,884 - root - INFO - displaying the df_report1
2023-10-14 18:39:36,001 - root - INFO - displaying data_report2 method....
2023-10-14 18:39:36,001 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:39:36,001 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:39:36,180 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:39:36,180 - root - INFO - displaying the df_report2
2023-10-14 18:39:47,815 - root - INFO - extracting files to Output....
2023-10-14 18:42:30,426 - root - INFO - i am in the main method...
2023-10-14 18:42:30,427 - root - INFO - calling spark object
2023-10-14 18:42:30,427 - root - INFO - get_spark_object method started
2023-10-14 18:42:30,427 - Create_spark - INFO - master is local
2023-10-14 18:42:37,954 - Create_spark - INFO - Spark object created........
2023-10-14 18:42:37,954 - root - INFO - Validating spark object.............
2023-10-14 18:42:37,954 - Validate - WARNING - started the get_current_date method...
2023-10-14 18:42:44,859 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 18:42:44,859 - Validate - WARNING - Validation done , go frwd....
2023-10-14 18:42:44,860 - root - INFO - reading file which is of > parquet 
2023-10-14 18:42:44,860 - Ingest - WARNING - load_files method started
2023-10-14 18:42:45,784 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:42:45,784 - root - INFO - displaying file
2023-10-14 18:42:48,383 - root - INFO - validating the dataframe....
2023-10-14 18:42:48,383 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 18:42:49,225 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 18:42:49,225 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 18:42:49,225 - root - INFO - reading file which is of > csv
2023-10-14 18:42:49,225 - Ingest - WARNING - load_files method started
2023-10-14 18:42:56,449 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 18:42:56,449 - root - INFO - displaying the df_fact dataframe
2023-10-14 18:42:57,172 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 18:42:58,384 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 18:42:58,384 - root - INFO - implementing data_processing methods.....
2023-10-14 18:42:58,384 - Data_processing - WARNING - data_clean method() started....
2023-10-14 18:42:58,384 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 18:42:58,434 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 18:42:58,458 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 18:42:58,479 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 18:42:58,552 - Data_processing - WARNING - concat first and lname 
2023-10-14 18:42:58,603 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 18:42:58,643 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 18:42:58,643 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 18:42:58,711 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 18:43:02,576 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 18:43:02,576 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 18:43:02,576 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 18:43:03,433 - root - INFO - validating schema for the dataframes.......
2023-10-14 18:43:03,433 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 18:43:03,434 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 18:43:03,434 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 18:43:03,434 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 18:43:03,434 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 18:43:03,434 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 18:43:03,434 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 18:43:03,434 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:43:03,434 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 18:43:03,435 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 18:43:03,436 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 18:43:03,436 - Validate - INFO - print_schema done, go frwd....
2023-10-14 18:43:03,618 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 18:43:03,618 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 18:43:03,876 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 18:43:32,623 - root - INFO - data_transformation executing.....
2023-10-14 18:43:32,623 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 18:43:32,624 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 18:43:32,670 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 18:43:32,717 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 18:43:32,792 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 18:43:32,792 - root - INFO - displaying the df_report1
2023-10-14 18:43:48,456 - root - INFO - displaying data_report2 method....
2023-10-14 18:43:48,456 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 18:43:48,456 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 18:43:48,636 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 18:43:48,636 - root - INFO - displaying the df_report2
2023-10-14 18:44:01,607 - root - INFO - extracting files to Output....
2023-10-14 18:44:01,608 - root - INFO - extracting files to Output completed....
2023-10-14 18:44:01,608 - root - INFO - Application done
2023-10-14 19:51:31,285 - root - INFO - i am in the main method...
2023-10-14 19:51:31,286 - root - INFO - calling spark object
2023-10-14 19:51:31,286 - root - INFO - get_spark_object method started
2023-10-14 19:51:31,286 - Create_spark - INFO - master is local
2023-10-14 19:51:47,363 - Create_spark - INFO - Spark object created........
2023-10-14 19:51:47,364 - root - INFO - Validating spark object.............
2023-10-14 19:51:47,364 - Validate - WARNING - started the get_current_date method...
2023-10-14 19:52:04,131 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 19:52:04,131 - Validate - WARNING - Validation done , go frwd....
2023-10-14 19:52:04,132 - root - INFO - reading file which is of > parquet 
2023-10-14 19:52:04,132 - Ingest - WARNING - load_files method started
2023-10-14 19:52:05,517 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 19:52:05,518 - root - INFO - displaying file
2023-10-14 19:52:12,809 - root - INFO - validating the dataframe....
2023-10-14 19:52:12,810 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 19:52:14,197 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 19:52:14,197 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 19:52:14,198 - root - INFO - reading file which is of > csv
2023-10-14 19:52:14,198 - Ingest - WARNING - load_files method started
2023-10-14 19:52:38,585 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 19:52:38,585 - root - INFO - displaying the df_fact dataframe
2023-10-14 19:52:40,349 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 19:52:43,983 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 19:52:43,983 - root - INFO - implementing data_processing methods.....
2023-10-14 19:52:43,983 - Data_processing - WARNING - data_clean method() started....
2023-10-14 19:52:43,983 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 19:52:44,114 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 19:52:44,167 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 19:52:44,212 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 19:52:44,357 - Data_processing - WARNING - concat first and lname 
2023-10-14 19:52:44,455 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 19:52:44,511 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 19:52:44,511 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 19:52:44,655 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 19:52:56,966 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 19:52:56,967 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 19:52:56,967 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 19:53:00,783 - root - INFO - validating schema for the dataframes.......
2023-10-14 19:53:00,783 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 19:53:00,786 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 19:53:00,786 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 19:53:00,786 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 19:53:00,786 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 19:53:00,786 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 19:53:00,786 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 19:53:00,787 - Validate - INFO - print_schema done, go frwd....
2023-10-14 19:53:00,787 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 19:53:00,789 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 19:53:00,790 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 19:53:00,790 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 19:53:00,790 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 19:53:00,790 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 19:53:00,790 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 19:53:00,790 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 19:53:00,791 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 19:53:00,791 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 19:53:00,791 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 19:53:00,791 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 19:53:00,791 - Validate - INFO - print_schema done, go frwd....
2023-10-14 19:53:01,930 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 19:53:01,931 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 19:53:02,443 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 19:54:12,302 - root - INFO - data_transformation executing.....
2023-10-14 19:54:12,303 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 19:54:12,304 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 19:54:12,381 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 19:54:12,431 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 19:54:12,533 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 19:54:12,533 - root - INFO - displaying the df_report1
2023-10-14 19:54:49,326 - root - INFO - displaying data_report2 method....
2023-10-14 19:54:49,326 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 19:54:49,328 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 19:54:49,593 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 19:54:49,593 - root - INFO - displaying the df_report2
2023-10-14 19:55:12,814 - root - INFO - extracting files to Output....
2023-10-14 19:55:12,814 - root - INFO - extracting files to Output completed....
2023-10-14 19:55:12,815 - root - INFO - Application done
2023-10-14 20:16:51,150 - root - INFO - i am in the main method...
2023-10-14 20:16:51,150 - root - INFO - calling spark object
2023-10-14 20:16:51,150 - root - INFO - get_spark_object method started
2023-10-14 20:16:51,150 - Create_spark - INFO - master is local
2023-10-14 20:17:01,921 - Create_spark - INFO - Spark object created........
2023-10-14 20:17:01,921 - root - INFO - Validating spark object.............
2023-10-14 20:17:01,921 - Validate - WARNING - started the get_current_date method...
2023-10-14 20:17:18,545 - Validate - WARNING - validating spark object with current date - [Row(current_date()=datetime.date(2023, 10, 14))]
2023-10-14 20:17:18,545 - Validate - WARNING - Validation done , go frwd....
2023-10-14 20:17:18,546 - root - INFO - reading file which is of > parquet 
2023-10-14 20:17:18,546 - Ingest - WARNING - load_files method started
2023-10-14 20:17:20,590 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 20:17:20,590 - root - INFO - displaying file
2023-10-14 20:17:28,047 - root - INFO - validating the dataframe....
2023-10-14 20:17:28,047 - Ingest - WARNING - here to count the records in the df_city
2023-10-14 20:17:29,213 - Ingest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2023-10-14 20:17:29,213 - root - INFO - checking for the files in the Fact/oltp......
2023-10-14 20:17:29,214 - root - INFO - reading file which is of > csv
2023-10-14 20:17:29,215 - Ingest - WARNING - load_files method started
2023-10-14 20:17:51,574 - Ingest - WARNING - Load_files func done, go fwd..
2023-10-14 20:17:51,575 - root - INFO - displaying the df_fact dataframe
2023-10-14 20:17:55,196 - Ingest - WARNING - here to count the records in the df_fact
2023-10-14 20:18:01,755 - Ingest - WARNING - Number of records present in the DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string] are :: 1329329
2023-10-14 20:18:01,755 - root - INFO - implementing data_processing methods.....
2023-10-14 20:18:01,755 - Data_processing - WARNING - data_clean method() started....
2023-10-14 20:18:01,756 - Data_processing - WARNING - selecting required columns and converting some of columns into UpperCase....
2023-10-14 20:18:01,970 - Data_processing - WARNING - working on OLTP dataset and selecting couple of columns and rename...
2023-10-14 20:18:02,073 - Data_processing - WARNING - Adding a new column to df_presc_sel
2023-10-14 20:18:02,258 - Data_processing - WARNING - converting Year_Of_exp string to Int and repla cing =
2023-10-14 20:18:02,455 - Data_processing - WARNING - concat first and lname 
2023-10-14 20:18:02,508 - Data_processing - WARNING - now dropping presc_lname and presc_fname
2023-10-14 20:18:02,583 - Data_processing - WARNING - now check for null values in all columns
2023-10-14 20:18:02,584 - Data_processing - WARNING - drop the null values in the respective columns....
2023-10-14 20:18:02,640 - Data_processing - WARNING - fill the null values in tx_cnt with the avg values........
2023-10-14 20:18:27,547 - Data_processing - WARNING - successfully dropped the null values....
2023-10-14 20:18:27,547 - Data_processing - WARNING - check for the null values cleaned or not.......
2023-10-14 20:18:27,547 - Data_processing - WARNING - data_clean method() executed done, go frwd.....
2023-10-14 20:18:30,272 - root - INFO - validating schema for the dataframes.......
2023-10-14 20:18:30,273 - Validate - WARNING - print schema method executing......df_city_sel
2023-10-14 20:18:30,275 - Validate - INFO - 	StructField('city', StringType(), True)
2023-10-14 20:18:30,275 - Validate - INFO - 	StructField('state_id', StringType(), True)
2023-10-14 20:18:30,275 - Validate - INFO - 	StructField('state_name', StringType(), True)
2023-10-14 20:18:30,276 - Validate - INFO - 	StructField('county_name', StringType(), True)
2023-10-14 20:18:30,276 - Validate - INFO - 	StructField('population', IntegerType(), True)
2023-10-14 20:18:30,276 - Validate - INFO - 	StructField('zips', StringType(), True)
2023-10-14 20:18:30,276 - Validate - INFO - print_schema done, go frwd....
2023-10-14 20:18:30,276 - Validate - WARNING - print schema method executing......df_presc_sel
2023-10-14 20:18:30,282 - Validate - INFO - 	StructField('presc_id', IntegerType(), True)
2023-10-14 20:18:30,282 - Validate - INFO - 	StructField('presc_city', StringType(), True)
2023-10-14 20:18:30,282 - Validate - INFO - 	StructField('presc_state', StringType(), True)
2023-10-14 20:18:30,282 - Validate - INFO - 	StructField('presc_spclt', StringType(), True)
2023-10-14 20:18:30,283 - Validate - INFO - 	StructField('drug_name', StringType(), True)
2023-10-14 20:18:30,284 - Validate - INFO - 	StructField('tx_cnt', IntegerType(), True)
2023-10-14 20:18:30,286 - Validate - INFO - 	StructField('total_day_supply', IntegerType(), True)
2023-10-14 20:18:30,286 - Validate - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2023-10-14 20:18:30,287 - Validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2023-10-14 20:18:30,287 - Validate - INFO - 	StructField('Country_name', StringType(), False)
2023-10-14 20:18:30,287 - Validate - INFO - 	StructField('presc_fullname', StringType(), False)
2023-10-14 20:18:30,287 - Validate - INFO - print_schema done, go frwd....
2023-10-14 20:18:30,878 - root - INFO - checking for null values in the dataframes....after processing 
2023-10-14 20:18:30,879 - Validate - INFO - check for nulls methods executing......df_fact
2023-10-14 20:18:31,438 - Validate - WARNING - check_for_nulls executed successfully....
2023-10-14 20:19:37,241 - root - INFO - data_transformation executing.....
2023-10-14 20:19:37,242 - Data_transformation - WARNING - processing the data_report1 method....
2023-10-14 20:19:37,244 - Data_transformation - WARNING - calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2023-10-14 20:19:37,340 - Data_transformation - WARNING - calculating distinct prescribers and total tx_cnt
2023-10-14 20:19:37,395 - Data_transformation - WARNING -  Don't report the city if no prescriber is assigned to it ......
2023-10-14 20:19:37,529 - Data_transformation - WARNING - data_report1 successfully executed....., go frwd
2023-10-14 20:19:37,529 - root - INFO - displaying the df_report1
2023-10-14 20:20:34,523 - root - INFO - displaying data_report2 method....
2023-10-14 20:20:34,523 - Data_transformation - WARNING - processing the data_report2 method....
2023-10-14 20:20:34,523 - Data_transformation - WARNING - executing the task ::: consider the prescriber only from 20 to 50 years_of_exp and rank the prescribers based on their tx_cnt from each other
2023-10-14 20:20:34,975 - Data_transformation - WARNING - data_report2 successfully executed....., go frwd
2023-10-14 20:20:34,976 - root - INFO - displaying the df_report2
2023-10-14 20:21:13,164 - root - INFO - extracting files to Output....
2023-10-14 20:21:13,165 - root - INFO - extracting files to Output completed....
2023-10-14 20:21:13,166 - root - INFO - Application done
